<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>eNotas - Painel de Vendas</title>
<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: #f8f9fb;
    margin: 0;
    padding: 0;
  }

  /* Menu Superior */
  .top-menu {
    background: #fff;
    border-bottom: 2px solid #e5e5e5;
    padding: 0;
    margin-bottom: 30px;
    z-index: 9999;
  }

  .top-menu-items {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    gap: 0;
  }

  .menu-item {
    padding: 16px 24px;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    display: flex;
    align-items: center;
    gap: 8px;
    color: #666;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s;
    position: relative;
  }

  .menu-item:hover {
    background: #f8f9fb;
    color: #333;
  }

  .menu-item.active {
    color: #1abc9c;
    border-bottom-color: #1abc9c;
  }

  .menu-item svg {
    width: 18px;
    height: 18px;
  }

  /* Submenu Dropdown */
  .submenu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background: #fff;
    border: 1px solid #e5e5e5;
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    min-width: 180px;
    z-index: 100;
    margin-top: 3px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s;
  }

  .menu-item:hover .submenu {
    display: block;
    opacity: 1;
    pointer-events: all;
  }

  .submenu-item {
    padding: 12px 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    color: #555;
    font-size: 14px;
    transition: background 0.2s;
  }

  .submenu-item:hover {
    background: #f8f9fb;
  }

  .submenu-item svg {
    width: 16px;
    height: 16px;
  }

  /* Apps Page */
  .apps-page {
    display: none;
    max-width: 1200px;
    margin: 30px auto;
    padding: 0 20px;
    position: relative;
  }

  .apps-page.active {
    display: block !important;
  }

  .apps-close-btn {
    position: fixed;
    top: 80px;
    right: 30px;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: #e53935;
    border: 2px solid #fff;
    color: #fff;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    z-index: 999;
    transition: all 0.2s;
  }

  .apps-close-btn:hover {
    background: #c62828;
    transform: scale(1.1);
  }

  .apps-header {
    text-align: center;
    margin-bottom: 40px;
  }

  .apps-icon {
    width: 60px;
    height: 60px;
    background: #5a6c7d;
    border-radius: 12px;
    display: flex;
    margin: 0 auto 20px;
    position: relative;
  }

  .apps-icon::before,
  .apps-icon::after {
    content: '';
    position: absolute;
    background: #fff;
    border-radius: 3px;
  }

  .apps-icon::before {
    width: 22px;
    height: 22px;
    top: 10px;
    left: 10px;
  }

  .apps-icon::after {
    width: 22px;
    height: 22px;
    bottom: 10px;
    right: 10px;
  }

  .apps-header h2 {
    font-size: 24px;
    color: #5a6c7d;
    margin: 0 0 8px;
  }

  .apps-header p {
    color: #666;
    margin: 0;
  }

  .apps-header a {
    color: #1abc9c;
    text-decoration: none;
  }

  .apps-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
  }

  .app-card {
    background: #fff;
    border: 1px solid #e5e5e5;
    border-radius: 8px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .app-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
  }

  .app-info h3 {
    margin: 0 0 4px;
    font-size: 16px;
    color: #333;
  }

  .app-info p {
    margin: 0;
    font-size: 13px;
    color: #666;
  }

  .app-logo {
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .app-logo img {
    max-width: 100%;
    max-height: 100%;
  }

  .btn-ativar-app {
    background: #fff;
    border: 1px solid #1abc9c;
    color: #1abc9c;
    padding: 8px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s;
  }

  .btn-ativar-app:hover {
    background: #1abc9c;
    color: #fff;
  }

  /* Modal de Integra√ß√£o */
  .integracao-modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    z-index: 10000;
    align-items: center;
    justify-content: center;
  }

  .integracao-modal.open {
    display: flex !important;
  }

  .integracao-content {
    width: min(800px, 92%);
    max-height: 85vh;
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .integracao-header {
    background: #fff;
    padding: 24px;
    border-bottom: 1px solid #e5e5e5;
    text-align: center;
  }

  .integracao-logo {
    width: 60px;
    height: 60px;
    margin: 0 auto 16px;
    background: #ff6b35;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 32px;
    color: #fff;
  }

  .integracao-body {
    flex: 1;
    overflow-y: auto;
    padding: 24px;
  }

  .integracao-form {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .form-group label {
    font-size: 14px;
    font-weight: 500;
    color: #333;
  }

  .form-group input {
    padding: 10px 12px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 14px;
  }

  .form-help {
    font-size: 13px;
    color: #666;
    line-height: 1.5;
  }

  .form-help a {
    color: #1a73e8;
    text-decoration: underline;
    cursor: pointer;
  }

  .visualizar-btn {
    background: transparent;
    border: none;
    color: #1a73e8;
    text-decoration: underline;
    cursor: pointer;
    padding: 0;
    font-size: 13px;
  }

  .integracao-actions {
    padding: 20px 24px;
    border-top: 1px solid #e5e5e5;
    display: flex;
    justify-content: space-between;
  }

  .btn-cancelar, .btn-salvar {
    padding: 10px 24px;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
  }

  .btn-cancelar {
    background: #fff;
    border: 1px solid #ccc;
    color: #666;
  }

  .btn-salvar {
    background: #1abc9c;
    border: none;
    color: #fff;
  }

  .btn-salvar:hover {
    background: #16a085;
  }
  
  /* Modal de Importa√ß√£o de Vendas */
.importacao-modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  z-index: 10001;
  align-items: center;
  justify-content: center;
}

.importacao-modal.open {
  display: flex !important;
}

.importacao-content {
  width: min(500px, 92%);
  background: #fff;
  border-radius: 8px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.importacao-header {
  background: #fff;
  padding: 24px;
  border-bottom: 1px solid #e5e5e5;
  text-align: center;
}

.importacao-header h3 {
  margin: 0;
  font-size: 18px;
  color: #333;
}

.importacao-body {
  padding: 24px;
}

.importacao-form {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.form-row-periodo {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.radio-group {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.radio-option {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
}

.radio-option:hover {
  background: #f8f9fb;
  border-color: #1abc9c;
}

.radio-option input[type="radio"] {
  margin: 0;
  cursor: pointer;
}

.radio-option label {
  cursor: pointer;
  flex: 1;
  font-size: 14px;
  color: #333;
  margin: 0;
}

.importacao-actions {
  padding: 20px 24px;
  border-top: 1px solid #e5e5e5;
  display: flex;
  justify-content: space-between;
}

.btn-importar-vendas:hover {
  background: #16a085 !important;
}

  /* P√°gina de Vendas */
  .vendas-page {
    display: block;
  }

  .vendas-page.hidden {
    display: none;
  }

  .container {
    max-width: 1200px;
    margin: 30px auto;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    overflow: hidden;
  }

  /* BANNERS SUPERIORES */
  .banners {
    display: flex;
    border-bottom: 1px solid #e5e5e5;
  }

  .banner {
    flex: 1;
    padding: 16px 20px;
    position: relative;
    color: #fff;
    transition: all 0.3s ease;
  }

  .banner h3 {
    margin: 0 0 8px;
    font-size: 16px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .banner ul {
    margin: 0;
    padding-left: 20px;
    color: #fff;
  }

  .banner a {
    color: #cce0ff;
    text-decoration: underline;
    cursor: pointer;
  }

  .banner.roxo { background: #7b3fc5; }
  .banner.verde { background: #1abc9c; }

  .expandir {
    position: absolute;
    top: 10px;
    right: 12px;
    cursor: pointer;
    font-weight: bold;
    font-size: 18px;
    opacity: 0.8;
  }

  .expandir:hover { opacity: 1; }

  .banner.expandido {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 100;
    overflow-y: auto;
    border-radius: 0;
    padding: 40px;
  }
  
  /* Banners minimizados */
.banner.minimizado {
  position: fixed;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 60px;
  height: 60px;
  border-radius: 0 30px 30px 0;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  z-index: 100;
  transition: all 0.3s ease;
  box-shadow: 2px 0 8px rgba(0,0,0,0.15);
}

.banner.minimizado:hover {
  width: 70px;
  box-shadow: 3px 0 12px rgba(0,0,0,0.25);
}

.banner.minimizado h3,
.banner.minimizado ul,
.banner.minimizado .expandir,
.banner.minimizado .fechar-internal,
.banner.minimizado .minimizar {
  display: none !important;
}

.banner.minimizado .emoji-indicador {
  display: block !important;
  font-size: 32px;
}

.banner.roxo.minimizado {
  top: calc(50% - 70px);
}

.banner.verde.minimizado {
  top: calc(50% + 10px);
}

.emoji-indicador {
  display: none;
}

/* Bot√£o minimizar */
.minimizar {
  position: absolute;
  top: 10px;
  right: 40px;
  cursor: pointer;
  font-weight: bold;
  font-size: 18px;
  opacity: 0.8;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.minimizar:hover {
  opacity: 1;
}

.banner.expandido .minimizar {
  display: none;
}

  .banner.expandido .expandir::after {
    content: "‚úï";
  }

  /* X dentro do banner ao expandir (no canto superior direito, dentro do overlay) */
  .fechar-internal {
    display: none; /* oculto por padr√£o; aparece apenas no expandido */
  }

  /* Ao expandir, colocar o X dentro do overlay, no canto superior direito */
  .banner.expandido .fechar-internal {
    display: inline-flex;
    position: fixed;
    top: 12px;
    right: 12px;
    width: 38px;
    height: 38px;
    border-radius: 4px;
    border: 2px solid #fff;
    background: #e53935;
    color: #fff;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-weight: bold;
    z-index: 101;
  }
  .banner.expandido .fechar-internal:hover {
    background: #c62828;
  }

  /* Ocultar o bot√£o expandir ao expandir o banner */
  .banner.expandido .expandir {
    display: none;
  }

  /* A√ß√µes em Massa ‚Äì estilo da √°rea com t√≠tulo e dropdown */
  .acoes {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    background: #fafafa;
    position: relative;
  }

  .acoes .titulo {
    font-weight: 600;
    cursor: pointer;
    padding: 6px 10px;
    border-radius: 6px;
    border: 1px solid #ddd;
    background: #fff;
  }

  .acoes-dropdown {
    display: none;
    position: absolute;
    left: 0;
    top: calc(100% + 6px);
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,.15);
    z-index: 40;
  }

  .acoes-dropdown button {
    display: block;
    width: 240px;
    background: #f8f8f8;
    border: 1px solid #ddd;
    padding: 8px 12px;
    text-align: left;
    border-radius: 6px;
    cursor: pointer;
    margin: 2px 0;
  }

  .acoes-dropdown button:hover {
    background: #eaeaea;
  }

  /* bot√£o de filtro (funil) */
  .btnFiltro {
    margin-left: auto;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 6px;
    background: #fff;
    cursor: pointer;
  }
  .btnFiltro svg {
    width: 16px; height: 16px;
  }

  .filtros-panel {
    display: none;
    position: absolute;
    right: 14px;
    top: 46px;
    width: 320px;
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 12px;
    box-shadow: 0 8px 20px rgba(0,0,0,.15);
    z-index: 50;
  }

  .filtros-panel h4 {
    margin: 0 0 8px;
    font-size: 14px;
    font-weight: 700;
  }

  .filtros-row {
    display: flex;
    gap: 8px;
    align-items: center;
    margin: 6px 0;
  }

  .filtros-panel label {
    font-size: 12px;
    color: #555;
  }

  .filtros-panel input, .filtros-panel select {
    font: inherit;
    padding: 6px 8px;
    border-radius: 4px;
    border: 1px solid #ccc;
  }

  .filtros-actions {
    display: flex;
    justify-content: space-between;
    margin-top: 6px;
  }

  .filtros-actions button {
    padding: 6px 12px;
    border-radius: 4px;
    border: 1px solid #ccc;
    background: #fff;
    cursor: pointer;
  }

  .filtros-actions button:hover {
    background: #f0f0f0;
  }

  /* Chatbot flutuante */
  .chatbot-bubble {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #7b3fc5, #9b5fd5);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(123, 63, 197, 0.4);
    transition: all 0.3s ease;
    z-index: 1000;
  }

  .chatbot-bubble:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 16px rgba(123, 63, 197, 0.6);
  }

  .chatbot-bubble svg {
    width: 32px;
    height: 32px;
    fill: #fff;
  }

  .chatbot-window {
    display: none;
    position: fixed;
    bottom: 90px;
    right: 20px;
    width: 350px;
    height: 500px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.2);
    flex-direction: column;
    z-index: 1001;
    overflow: hidden;
  }

  .chatbot-window.open {
    display: flex;
  }

  .chatbot-header {
    background: linear-gradient(135deg, #7b3fc5, #9b5fd5);
    color: #fff;
    padding: 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .chatbot-header h3 {
    margin: 0;
    font-size: 16px;
  }

  .chatbot-close {
    background: transparent;
    border: none;
    color: #fff;
    font-size: 20px;
    cursor: pointer;
    padding: 0;
    width: 24px;
    height: 24px;
  }

  .chatbot-messages {
    flex: 1;
    padding: 16px;
    overflow-y: auto;
    background: #f8f9fb;
  }

  .chat-message {
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
  }

  .chat-message.bot {
    align-items: flex-start;
  }

  .chat-message.user {
    align-items: flex-end;
  }

  .message-bubble {
    max-width: 75%;
    padding: 10px 14px;
    border-radius: 12px;
    font-size: 14px;
    line-height: 1.4;
  }

  .chat-message.bot .message-bubble {
    background: #fff;
    color: #333;
    border: 1px solid #e0e0e0;
  }

  .chat-message.user .message-bubble {
    background: #7b3fc5;
    color: #fff;
  }

  .chatbot-input {
    padding: 12px;
    border-top: 1px solid #e0e0e0;
    display: flex;
    gap: 8px;
  }

  .chatbot-input input {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 20px;
    font-size: 14px;
  }

  .chatbot-input button {
    background: #7b3fc5;
    color: #fff;
    border: none;
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 14px;
  }

  .chatbot-input button:hover {
    background: #6b2fb5;
  }

  /* Tabela de notas n√£o emitidas */
  .notas-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 12px;
  }

  .notas-table th,
  .notas-table td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #e0e0e0;
    font-size: 13px;
  }

  .notas-table th {
    background: #f5f5f5;
    font-weight: 600;
    color: #555;
  }

  .notas-table tbody tr:hover {
    background: #fafafa;
  }

  .btn-corrigir {
    background: #7b3fc5;
    color: #fff;
    border: none;
    padding: 4px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
  }

  .btn-corrigir:hover {
    background: #6b2fb5;
  }

  /* Modal de visualiza√ß√£o de nota fiscal */
  .nota-modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.5);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 10000;
  }

  .nota-modal.open {
    display: flex;
  }

  .nota-modal-content {
    width: min(800px, 92%);
    max-height: 85vh;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .nota-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    background: #f5f5f5;
    border-bottom: 1px solid #ddd;
  }

  .nota-modal-header h3 {
    margin: 0;
    font-size: 18px;
    color: #333;
  }

  .nota-modal-actions {
    display: flex;
    gap: 10px;
  }

  .btn-download, .btn-close-modal {
    padding: 8px 12px;
    border-radius: 6px;
    border: 1px solid #ccc;
    background: #fff;
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .btn-download {
    background: #7b3fc5;
    color: #fff;
    border-color: #7b3fc5;
  }

  .btn-download:hover {
    background: #6b2fb5;
  }

  .btn-close-modal:hover {
    background: #f0f0f0;
  }

  .nota-modal-body {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
  }

  .nota-fiscal {
    font-family: 'Courier New', monospace;
    font-size: 12px;
    line-height: 1.6;
    color: #000;
  }

  .nota-fiscal-header {
    text-align: center;
    border-bottom: 2px solid #000;
    padding-bottom: 12px;
    margin-bottom: 16px;
  }

  .nota-fiscal-title {
    font-size: 14px;
    font-weight: bold;
    margin-bottom: 4px;
  }

  .nota-fiscal-subtitle {
    font-size: 11px;
    margin: 2px 0;
  }

  .nota-fiscal-section {
    margin-bottom: 16px;
    padding: 10px;
    border: 1px solid #ccc;
    background: #f9f9f9;
  }

  .nota-fiscal-section-title {
    font-weight: bold;
    font-size: 13px;
    margin-bottom: 8px;
    color: #333;
    text-transform: uppercase;
  }

  .nota-fiscal-row {
    display: flex;
    justify-content: space-between;
    margin: 4px 0;
  }

  .nota-fiscal-label {
    font-weight: bold;
  }

  .nota-fiscal-info-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
    margin-top: 8px;
  }

  .nota-fiscal-full-width {
    grid-column: 1 / -1;
  }

  /* TABELA */
  table {
    width: 100%;
    border-collapse: collapse;
  }

  thead {
    background: #f2f3f5;
    color: #555;
    text-align: left;
  }

  th, td {
    padding: 12px 16px;
    border-bottom: 1px solid #eee;
    font-size: 14px;
  }

  tbody {
    display: block;
    max-height: 320px;
    overflow-y: auto;
  }

  thead, tbody tr {
    display: table;
    width: 100%;
    table-layout: fixed;
  }

  tbody tr:hover {
    background: #fafafa;
  }

  .checkboxCol {
    width: 40px;
  }

  .badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 13px;
    font-weight: 500;
  }

  .badge.emitida {
    background: #d4f5e0;
    color: #2e8b57;
  }

  .badge.pendente {
    background: #ffe6b3;
    color: #a87b00;
  }

  .badge.erro {
    background: #ffebee;
    color: #c62828;
  }

  .icon {
    width: 16px;
    height: 16px;
    vertical-align: middle;
  }

  .tooltip {
    position: relative;
    display: inline-block;
  }

  .tooltip .tooltiptext {
    visibility: hidden;
    background-color: #333;
    color: #fff;
    text-align: center;
    padding: 4px 8px;
    border-radius: 6px;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    transform: translateX(-50%);
    font-size: 12px;
    white-space: nowrap;
  }

  .tooltip:hover .tooltiptext {
    visibility: visible;
  }

  .btn-acao {
    background: #7b3fc5;
    color: #fff;
    border: none;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
  }

  .btn-acao:hover {
    background: #6b2fb5;
  }

  /* A√á√ïES EM MASSA E PAGINA√á√ÉO */
  .paginacao {
    display: flex;
    align-items: center;
    gap: 10px;
    justify-content:flex-end;
    padding: 12px 20px;
  }

  .paginacao button {
    border: 1px solid #ccc;
    background: #fff;
    padding: 4px 10px;
    border-radius: 6px;
    cursor: pointer;
  }

  .paginacao button:hover {
    background: #f1f1f1;
  }

  /* P√°gina info (texto de pagina√ß√£o) */
  #paginaInfo {
    color: #555;
    font-size: 14px;
  }

  /* Popup inline (n√£o sair da tela) - vers√£o solicitada */
  .inlinePopupBackdrop {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.45);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
  }
  .inlinePopupContent {
    width: min(720px, 92%);
    background: #fff;
    border-radius: 6px;
    padding: 16px;
    box-shadow: 0 8px 24px rgba(0,0,0,.25);
    position: relative;
  }
  /* X pequeno e quase invis√≠vel; aparece ao passar o mouse */
  .inlinePopupClose {
    position: absolute;
    top: 6px;
    right: 6px;
    width: 18px;
    height: 18px;
    border-radius: 3px;
    border: none;
    background: rgba(0,0,0,.15);
    color: #fff;
    font-size: 12px;
    cursor: pointer;
    opacity: 0.25;
    transition: opacity .2s;
  }
  .inlinePopupBackdrop:hover .inlinePopupClose {
    opacity: 0.85;
  }
  .inlinePopupContent p {
    margin: 0;
    font-size: 14px;
    line-height: 1.5;
    color: #333;
  }

  /* Cert modal (layout semelhante ao print) */
  #certModal {
    display: none;
  }
  .modal {
    display: none;
  }
  #certModal.modalVisible {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.45);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 999;
  }
  .certContent {
    width: min(900px, 92%);
    background: #fff;
    border-radius: 6px;
    padding: 16px 20px 14px;
    box-shadow: 0 8px 24px rgba(0,0,0,.25);
  }
  .certHeader {
    font-size: 20px;
    font-weight: 700;
    color: #333;
    margin-bottom: 8px;
  }
  .progressWrap {
    height: 6px;
    background: #eee;
    border-radius: 3px;
    overflow: hidden;
    margin: 8px 0 12px;
  }
  .progressBar {
    height: 6px;
    background: #4a6be0;
    width: 60%;
  }
  .alertBar {
    background: #d9eefc;
    color: #0d3b66;
    border-left: 4px solid #4a90e2;
    padding: 12px 14px;
    border-radius: 4px;
    margin: 12px 0;
  }
  .dropArea {
    height: 120px;
    border: 2px dashed #d0d0d0;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #555;
    background: #f9f9f9;
    margin: 6px 0 12px;
  }
  .certForm {
    display: grid;
    grid-template-columns: 140px 1fr;
    gap: 8px 12px;
    align-items: center;
    margin: 4px 0 8px;
  }
  .certForm input {
    padding: 6px 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  .modalActions {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 6px;
  }
  .btnVoltar, .btnConcluir {
    padding: 8px 14px;
    border-radius: 6px;
    border: 1px solid #ccc;
    background: #fff;
    cursor: pointer;
  }
  .btnConcluir {
    background: #18a999;
    border-color: #0b8a6b;
    color: #fff;
  }
  .btnConcluir:hover { background: #128f8b; }
  .btnVoltar { background: #f5f5f5; }

  /* Bot√£o de Ajuda Superior */
  
          .ajuda-superior {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 60;
        }

        .btn-ajuda {
            background: #1abc9c;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(26, 188, 156, 0.3);
            transition: all 0.2s;
            position: relative;
        }

        .btn-ajuda:hover {
            background: #16a085;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(26, 188, 156, 0.4);
        }

        .ajuda-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            min-width: 240px;
            z-index: 61;
        }

        .ajuda-dropdown.open {
            display: block;
        }

        .ajuda-dropdown-item {
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #333;
            text-decoration: none;
            transition: background 0.2s;
            border-bottom: 1px solid #f0f0f0;
            position: relative;
        }

        .ajuda-dropdown-item:last-child {
            border-bottom: none;
        }

        .ajuda-dropdown-item:hover {
            background: #f8f9fb;
        }

        .ajuda-dropdown-item svg {
            width: 20px;
            height: 20px;
            color: #666;
            flex-shrink: 0;
        }

        .badge-novo {
            background: #1abc9c;
            color: #fff;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: 600;
            margin-left: auto;
        }

        .ajuda-dropdown-subtitle {
            font-size: 11px;
            color: #999;
            display: block;
            margin-top: 2px;
        }

        /* Estilos da tabela */
        .tabela-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        thead {
            background-color: #f8f9fa;
        }

        th {
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            border-bottom: 2px solid #e0e0e0;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        tbody tr:hover {
            background-color: #f8f9fb;
        }

        .btn-visualizar {
            background: #3498db;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.2s;
        }

        .btn-visualizar:hover {
            background: #2980b9;
        }
  /* P√°gina de Empresa */
  .empresa-page {
    display: none;
    max-width: 1200px;
    margin: 30px auto;
    padding: 0 20px;
  }

  .empresa-page.active {
    display: block;
  }

  .empresa-container {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    padding: 60px 40px;
  }

  .empresa-header {
    text-align: center;
    margin-bottom: 50px;
  }

.progress-container {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 120px;  /* Adiciona espa√ßo entre os elementos */
  margin-bottom: 50px;
  position: relative;
  max-width: 500px;  
  margin-left: auto;
  margin-right: auto;
}

.progress-step {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  z-index: 2;
}

.progress-circle {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: #1abc9c;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  margin-bottom: 8px;
  box-shadow: none;
}

.progress-circle.inactive {
  background: #e8e8e8;
  color: #999;
  box-shadow: none;
}

.progress-line {
  width: 350px; 
  height: 3px;
  background: #1abc9c;
  position: absolute;
  top: 25px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1;
}

.progress-label {
  font-size: 13px;
  color: #1abc9c;
  font-weight: 500;
  text-align: center;
  line-height: 1.3;
  max-width: 80px;
}

.progress-label.inactive {
  color: #999;
}

  .empresa-content {
    max-width: 700px;
    margin: 0 auto;
  }

  .empresa-content h2 {
    font-size: 26px;
    color: #333;
    margin-bottom: 24px;
    font-weight: 600;
  }

  .empresa-content p {
    font-size: 15px;
    line-height: 1.7;
    color: #555;
    margin-bottom: 16px;
  }

  .empresa-actions {
    display: flex;
    gap: 12px;
    margin-top: 32px;
    flex-wrap: wrap;
  }

  .btn-configurar {
    background: #1abc9c;
    color: #fff;
    border: none;
    padding: 12px 24px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 15px;
    font-weight: 500;
    transition: background 0.2s;
  }

  .btn-configurar:hover {
    background: #16a085;
  }

  .btn-ajuda-empresa {
    background: #fff;
    color: #666;
    border: 1px solid #ccc;
    padding: 12px 24px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 15px;
    font-weight: 500;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .btn-ajuda-empresa:hover {
    background: #f5f5f5;
    border-color: #999;
  }

.btn-guia-config {
  background: #7b3fc5;
  color: #fff;
  border: 1px solid #7b3fc5;
  padding: 12px 24px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 15px;
  font-weight: 500;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 6px;
  text-decoration: none;
}

.btn-guia-config:hover {
  background: #6b2fb5;
  border-color: #6b2fb5;
}

.btn-guia-config svg {
  color: #fff;
}

</style>
</head>
<body>
  
<!-- Bot√£o de Ajuda Superior -->
<div class="ajuda-superior">
  <button class="btn-ajuda" onclick="toggleAjudaDropdown()">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"/>
      <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
      <line x1="12" y1="17" x2="12.01" y2="17"/>
    </svg>
    AJUDA
  </button>
  <div class="ajuda-dropdown" id="ajudaDropdown">
    <a href="#" class="ajuda-dropdown-item" onclick="event.preventDefault(); alert('Artigos e tutoriais');">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14 2 14 8 20 8"/>
        <line x1="16" y1="13" x2="8" y2="13"/>
        <line x1="16" y1="17" x2="8" y2="17"/>
      </svg>
      Artigos e tutoriais
    </a>
    <a href="https://enotas-configuracoes.hotmart.host/guiaconfiguracoes" target="_blank" rel="noopener" class="ajuda-dropdown-item">
  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
  </svg>
  Guia de Configura√ß√µes
  <span class="badge-novo">NOVO</span>
</a>
    <a href="#" class="ajuda-dropdown-item" onclick="event.preventDefault(); alert('Acompanhar o chamado');">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.35-4.35"/>
      </svg>
      Acompanhar o chamado
    </a>
    <a href="#" class="ajuda-dropdown-item" onclick="event.preventDefault(); alert('Solicitar ajuda do suporte');">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
      </svg>
      <div style="display: flex; flex-direction: column;">
        Solicitar ajuda do suporte
        <span class="ajuda-dropdown-subtitle">(Abrir chamado)</span>
      </div>
    </a>
  </div>
</div>  

<!-- Menu Superior -->
<div class="top-menu">
  <div class="top-menu-items">
    <div class="menu-item active" onclick="showVendas()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <polyline points="19 12 12 19 5 12"></polyline>
      </svg>
      Vendas
    </div>
    <div class="menu-item" id="menuGerenciar">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"></circle>
        <path d="M12 1v6m0 6v6m8.66-13.66l-4.24 4.24m-8.48 0L3.34 4.34M23 12h-6m-6 0H1m17.66 8.66l-4.24-4.24m-8.48 0l-4.24 4.24"></path>
      </svg>
      Gerenciar
      <div class="submenu" id="submenuGerenciar">
        <div class="submenu-item" id="btnClientes" onclick="alert('Clientes em desenvolvimento')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87m-4-12a4 4 0 0 1 0 7.75"></path>
          </svg>
          Clientes
        </div>
        <div class="submenu-item" id="btnProdutos" onclick="alert('Produtos em desenvolvimento')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <path d="M16 10a4 4 0 0 1-8 0"></path>
          </svg>
          Produtos
        </div>
        <div class="submenu-item" id="btnApps" onclick="showApps()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
          </svg>
          Apps
        </div>
      </div>
<div class="menu-item" onclick="showEmpresa()">
  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
    <polyline points="9 22 9 12 15 12 15 22"></polyline>
  </svg>
  Empresa
</div>
  </div>
</div>

<!-- P√°gina de Vendas (painel atual) -->
<div id="vendasPage" class="vendas-page">

<div class="container">

  <!-- BANNERS -->
<!-- BANNERS -->
<div class="banners">
  <div class="banner roxo" id="novidades" onclick="restaurarBanner('novidades', event)">
    <span class="emoji-indicador">üÜï</span>
    <span class="minimizar" onclick="minimizarBanner('novidades', event)">‚îÄ</span>
    <span class="expandir" onclick="expandirBanner('novidades')">‚õ∂</span>
    <button class="fechar-internal" aria-label="Fechar novidades" onclick="fecharBanner('novidades')">‚úñ</button>
    <h3>üÜï Novidades</h3>
    <ul>
      <li>Fique por dentro das novidades da reforma tribut√°ria, que ser√£o aplicadas a partir de Janeiro/2026. Clique <a href="#" onclick="openInlineMessage('Antecipando-se ao cronograma oficial do Governo, o eNotas come√ßar√° a fazer testes internos j√° com os campos dos novos tributos IBS/CBS nas notas fiscais neste m√™s de outubro. O objetivo √© garantir que esteja tudo pronto em dezembro, antes da virada, portanto, para a Reforma Tribut√°ria. √â nossa miss√£o garantir que todos os nossos clientes estejam sempre em compliance fiscal. Portanto, estaremos sempre prontos para cada nova fase da Reforma Tribut√°ria, para que voc√™ possa continuar focado apenas nas suas vendas, enquanto n√≥s cuidamos das notas fiscais. üöÄüòä. Para mais informa√ß√µes, clique aqui.', 'https://www.gov.br/fazenda/pt-br/acesso-a-informacao/acoes-e-programas/reforma-tributaria')">aqui</a>.</li>
      <li>Agora voc√™ tamb√©m pode emitir notas de seus produtos f√≠sicos vendidos na Hotmart, pelo eNotas. Para saber mais, clique <a href="#" onclick="event.preventDefault(); openProductInfoPopup();">aqui</a>.</li>
    </ul>
  </div>

  <div class="banner verde" id="avisos" onclick="restaurarBanner('avisos', event)">
    <span class="emoji-indicador">üö®</span>
    <span class="minimizar" onclick="minimizarBanner('avisos', event)">‚îÄ</span>
    <span class="expandir" onclick="expandirBanner('avisos')">‚õ∂</span>
    <button class="fechar-internal" aria-label="Fechar avisos" onclick="fecharBanner('avisos')">‚úñ</button>
    <h3>üö® Avisos</h3>
    <ul>
      <li>Voc√™ possui <b>20 notas fiscais n√£o emitidas</b>, clique <a href="#" onclick="event.preventDefault(); openNotasNaoEmitidasPopup();" style="color:#1a73e8; text-decoration:underline; cursor:pointer;">aqui</a> para detalhes.</li>
      <li>O seu certificado digital ir√° vencer em <b>10 dias</b>, clique <a href="#" onclick="openCertModal(event)" style="color:#1a73e8; text-decoration:underline; cursor:pointer;">aqui</a> para atualiz√°-lo.</li>
    </ul>
  </div>
</div>

  <!-- A√á√ïES EM MASSA + FILTROS -->
  <div class="acoes" style="position:relative;">
    <div class="titulo" onclick="toggleAcoesDropdown()">A√ß√µes em massa</div>
    <div id="acoesDropdown" class="acoes-dropdown" aria-label="A√ß√µes em massa dropdown" style="display:none;">
      <button onclick="handleAcoes('gerar')">Gerar nota fiscal</button>
      <button onclick="handleAcoes('copiar')">Copiar</button>
      <button onclick="handleAcoes('cancelar')">Cancelar</button>
      <button onclick="handleAcoes('enviar')">Enviar por e-mail</button>
    </div>

    <div style="display: flex; align-items: center; gap: 8px; margin-left: auto;">
    <button id="btnFiltro" class="btnFiltro" onclick="toggleFiltroPanel()" aria-label="Filtros" title="Filtros" style="margin-left: 0;">
      <span style="display:inline-flex; align-items:center; gap:6px;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-label="Filtro">
          <path d="M3 5h18M6 12h12M10 19h4"/>
        </svg>
        Filtros
      </span>
    </button>

<a href="https://enotas-configuracoes.hotmart.host/guiaconfiguracoes" target="_blank" rel="noopener" id="btnGuia" class="btnFiltro" aria-label="Guia" title="Guia" style="margin-left: 0; text-decoration: none; color: inherit; display: inline-flex; align-items: center; padding: 8px 12px;">
  <span style="display:inline-flex; align-items:center; gap:6px;">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-label="Guia">
      <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
      <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
    </svg>
    Guia
  </span>
</a>
  </div>

    <div id="filtrosPanel" class="filtros-panel" aria-label="Filtros panel" style="display:none;">
      <h4>Filtros</h4>
      <div class="filtros-row">
        <label>Data inicio</label>
        <input type="date" id="fDataInicio" />
      </div>
      <div class="filtros-row">
        <label>Data fim</label>
        <input type="date" id="fDataFim" />
      </div>
      <div class="filtros-row">
        <label>Cliente</label>
        <input type="text" id="fCliente" placeholder="Nome do cliente" />
      </div>
      <div class="filtros-row">
        <label>Produto</label>
        <input type="text" id="fProduto" placeholder="Produto" />
      </div>
      <div class="filtros-row">
        <label>Canal</label>
        <select id="fCanal">
          <option value="">Todos</option>
          <option>Venda Manual</option>
          <option>Hotmart</option>
        </select>
      </div>
      <div class="filtros-row">
        <label>Status</label>
        <select id="fStatus">
          <option value="">Todos</option>
          <option value="Emitida">Emitida</option>
          <option value="Pendente">Pendente</option>
        </select>
      </div>
      <div class="filtros-actions">
        <button onclick="clearFilters()">Limpar</button>
        <button onclick="applyFiltersFromUI()" style="background: #7b3fc5; color: #fff; border-color: #7b3fc5;">Aplicar</button>
      </div>
    </div>
  </div>
  


  <!-- TABELA -->
  <table>
    <thead>
      <tr>
        <th class="checkboxCol"></th>
        <th>Data</th>
        <th>Produto</th>
        <th>Cliente</th>
        <th>Valor</th>
        <th>Notas Fiscais</th>
        <th>Canal</th>
        <th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody id="tabelaVendas">
    </tbody>
  </table>

  <!-- PAGINA√á√ÉO COM SETAS -->
  <div class="paginacao" aria-label="Navega√ß√£o de p√°ginas" style="padding:0 20px 12px;">
    <button id="btnAnterior" onclick="anterior()" aria-label="P√°gina anterior" title="Anterior" style="border:1px solid #ccc; background:#fff; padding:4px 8px; border-radius:6px; cursor:pointer">&lt;</button>
    <span id="paginaInfo" style="margin:0 10px; color:#555;">P√°gina 1 de 3</span>
    <select id="paginaSelector" onchange="goToPage(this.value)" style="border:1px solid #ccc; border-radius:6px; padding:4px 6px;">
    </select>
    <button id="btnProximo" onclick="proxima()" aria-label="Pr√≥xima p√°gina" title="Pr√≥xima" style="border:1px solid #ccc; background:#fff; padding:4px 8px; border-radius:6px; cursor:pointer">&gt;</button>
  </div>

</div>

<!-- Certificado - modal (pop-up estilo print) -->
<div id="certModal" class="modal" aria-label="Modal Certificado Digital">
  <div class="certContent certModalContent" role="dialog" aria-labelledby="certModalTitle">
    <div class="certHeader" id="certModalTitle">Informa√ß√µes de sua empresa</div>
    <div class="progressWrap" aria-label="Progresso">
      <div class="progressBar"></div>
    </div>
    <div class="alertBar">
      Est√° sem um Certificado Digital? Adquira com uma empresa parceira e acelere o processo de compra ou renova√ß√£o
    </div>
    <div class="dropArea" aria-label="√Årea de carregamento de certificado">
      Arraste o arquivo .PFX ou .P12 do certificado digital ou clique aqui para selecion√°-lo.
    </div>

    <div class="certForm" aria-label="Formulario certificado">
      <label>Certificado digital</label>
      <input type="text" value="LBR MENTORIA E TREINAMENTOS LTDA:586800587000107" readonly />
      <label>Valido at√©</label>
      <input type="date" value="2025-10-15" readonly />
      <label>Senha</label>
      <input type="password" placeholder="" />
    </div>

    <div class="modalActions">
      <button class="btnVoltar" onclick="closeCertModal()">Voltar</button>
      <button class="btnConcluir" onclick="concluirCertModal()">Concluir</button>
    </div>
  </div>
</div>

<!-- Modal de visualiza√ß√£o de nota fiscal -->
<div class="nota-modal" id="notaModal">
  <div class="nota-modal-content">
    <div class="nota-modal-header">
      <h3>üìÑ Nota Fiscal de Servi√ßos Eletr√¥nica</h3>
      <div class="nota-modal-actions">
        <button class="btn-download" onclick="downloadNota()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          Baixar
        </button>
        <button class="btn-close-modal" onclick="closeNotaModal()">‚úï</button>
      </div>
    </div>
    <div class="nota-modal-body">
      <div class="nota-fiscal">
        <div class="nota-fiscal-header">
          <div class="nota-fiscal-title">NFS-e - NOTA FISCAL DE SERVI√áOS ELETR√îNICA - RPS 2142</div>
          <div class="nota-fiscal-subtitle">S√©rie 1, emitido em: 03/10/2025</div>
        </div>

        <div class="nota-fiscal-section">
          <div class="nota-fiscal-section-title">Dados do Prestador</div>
          <div><strong>LBR MENTORIA E TREINAMENTOS LTDA</strong></div>
          <div>RUA MANOEL EUFR√ÅSIO, 403 APT 171 ANDAR 16 COND RENAISSANCE ED</div>
          <div>JUVEV√ä - Curitiba - PR - 80030440</div>
          <div class="nota-fiscal-info-grid">
            <div>TELEFONE: 4192284899</div>
            <div>EMAIL: lilliana.bortolini@gmail.com</div>
            <div>CNPJ: 58.680.587/0001-07</div>
            <div>INSCRI√á√ÉO MUNICIPAL: 12107664</div>
          </div>
        </div>

        <div class="nota-fiscal-section">
          <div class="nota-fiscal-section-title">Informa√ß√µes da Nota</div>
          <div class="nota-fiscal-info-grid">
            <div><span class="nota-fiscal-label">N√öMERO DA NOTA:</span> 2194</div>
            <div><span class="nota-fiscal-label">COMPET√äNCIA:</span> 10/2025</div>
            <div><span class="nota-fiscal-label">C√ìDIGO DE VERIFICA√á√ÉO:</span> O4UUCA06</div>
            <div><span class="nota-fiscal-label">DATA DE EMISS√ÉO:</span> 03/10/2025 10:32:35</div>
          </div>
        </div>

        <div class="nota-fiscal-section">
          <div class="nota-fiscal-section-title">Dados do Tomador</div>
          <div class="nota-fiscal-info-grid">
            <div class="nota-fiscal-full-width"><span class="nota-fiscal-label">NOME / RAZ√ÉO SOCIAL:</span> Cliente Completo</div>
            <div><span class="nota-fiscal-label">CPF / CNPJ:</span> 111.444.777-35</div>
            <div><span class="nota-fiscal-label">E-MAIL:</span> teste@teste.com.br</div>
            <div class="nota-fiscal-full-width"><span class="nota-fiscal-label">ENDERE√áO:</span> Avenida Assis Chateaubriand, 499</div>
            <div><span class="nota-fiscal-label">BAIRRO:</span> Floresta</div>
            <div><span class="nota-fiscal-label">CEP:</span> 30150101</div>
            <div><span class="nota-fiscal-label">MUNIC√çPIO:</span> Belo Horizonte</div>
            <div><span class="nota-fiscal-label">UF:</span> MG</div>
          </div>
        </div>

        <div class="nota-fiscal-section">
          <div class="nota-fiscal-section-title">Discrimina√ß√£o dos Servi√ßos</div>
          <div style="margin-bottom: 8px;"><strong>Servi√ßo de Teste</strong></div>
          <div class="nota-fiscal-info-grid">
            <div class="nota-fiscal-full-width"><span class="nota-fiscal-label">C√ìDIGO DO SERVI√áO:</span> 802 - Treinamento em desenvolvimento profissional e gerencial</div>
            <div class="nota-fiscal-full-width"><span class="nota-fiscal-label">MUNIC√çPIO ONDE O SERVI√áO FOI PRESTADO:</span> 4106902 / Curitiba</div>
            <div class="nota-fiscal-full-width"><span class="nota-fiscal-label">NATUREZA DA OPERA√á√ÉO:</span> Tributa√ß√£o no munic√≠pio</div>
            <div class="nota-fiscal-full-width"><span class="nota-fiscal-label">REGIME ESPECIAL DE TRIBUTA√á√ÉO:</span> Microempresa Municipal</div>
          </div>
        </div>

        <div class="nota-fiscal-section">
          <div class="nota-fiscal-section-title">Valores</div>
          <div class="nota-fiscal-info-grid">
            <div><span class="nota-fiscal-label">VALOR DOS SERVI√áOS:</span> R$ 1,00</div>
            <div><span class="nota-fiscal-label">(-) DESCONTOS:</span> R$ 0,00</div>
            <div><span class="nota-fiscal-label">(-) DEDU√á√ïES:</span> R$ 0,00</div>
            <div><span class="nota-fiscal-label">(-) RETEN√á√ïES FEDERAIS:</span> R$ 0,00</div>
            <div><span class="nota-fiscal-label">(=) BASE DE C√ÅLCULO:</span> R$ 1,00</div>
            <div><span class="nota-fiscal-label">(-) ISS RETIDO NA FONTE:</span> R$ 0,00</div>
            <div><span class="nota-fiscal-label">(x) AL√çQUOTA:</span> 4,00 %</div>
            <div><span class="nota-fiscal-label">(=) VALOR DO ISS:</span> R$ 0,04</div>
            <div class="nota-fiscal-full-width" style="margin-top: 8px; padding-top: 8px; border-top: 2px solid #333;">
              <span class="nota-fiscal-label" style="font-size: 14px;">VALOR L√çQUIDO:</span> 
              <span style="font-size: 14px; font-weight: bold;">R$ 1,00</span>
            </div>
          </div>
        </div>

        <div class="nota-fiscal-section">
          <div class="nota-fiscal-section-title">Reten√ß√µes Federais</div>
          <div class="nota-fiscal-info-grid">
            <div><span class="nota-fiscal-label">PIS:</span> R$ 0,00</div>
            <div><span class="nota-fiscal-label">COFINS:</span> R$ 0,00</div>
            <div><span class="nota-fiscal-label">IR:</span> R$ 0,00</div>
            <div><span class="nota-fiscal-label">CSLL:</span> R$ 0,00</div>
            <div><span class="nota-fiscal-label">INSS:</span> R$ 0,00</div>
          </div>
        </div>

        <div class="nota-fiscal-section">
          <div class="nota-fiscal-section-title">Outras Informa√ß√µes</div>
          <div>Documento emitido por ME ou EPP optante pelo simples nacional;</div>
          <div style="margin-top: 8px; font-style: italic; color: #666;">powered by eNotas Gateway</div>
        </div>
      </div>
    </div>
  </div>
</div>

</div>
<!-- Fim P√°gina de Vendas -->
  
<!-- P√°gina de Empresa -->
<div id="empresaPage" class="empresa-page">
  <div class="empresa-container">
    <div class="empresa-header">
     <div class="progress-container">
  <div class="progress-step">
    <div class="progress-circle">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
      </svg>
    </div>
    <span class="progress-label">Conta criada</span>
  </div>
  <div class="progress-line"></div>
  <div class="progress-step">
    <div class="progress-circle inactive">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"/>
      </svg>
    </div>
    <span class="progress-label inactive">Configure<br>sua conta</span>
  </div>
</div>
    </div>

    <div class="empresa-content">
      <h2>Conta criada com sucesso</h2>
      <p>Em breve, nossos analistas entrar√£o em contato para ajudar na <strong>configura√ß√£o da sua conta</strong>.</p>
      <p>Para facilitar o processo, √© necess√°rio ter em m√£os os dados tribut√°rios da sua empresa que voc√™ pode conseguir <strong>solicitando ao seu contador</strong> ou atrav√©s de uma <strong>nota fiscal de servi√ßo j√° emitida anteriormente</strong>.</p>
      <p>Voc√™ pode iniciar a configura√ß√£o por conta pr√≥pria clicando no bot√£o abaixo.</p>

      <div class="empresa-actions">
        <button class="btn-configurar" onclick="alert('Configurar conta - Em desenvolvimento')">
          Configurar conta
        </button>
        <button class="btn-ajuda-empresa" onclick="alert('Ajuda - Em desenvolvimento')">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
          Ajuda
        </button>
        <a href="https://enotas-configuracoes.hotmart.host/guiaconfiguracoes" target="_blank" rel="noopener" class="btn-guia-config">
  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
  </svg>
  Guia de Configura√ß√µes
</a>
      </div>
    </div>
  </div>
</div>

<!-- P√°gina de Apps -->
<div id="appsPage" class="apps-page">
  <button class="apps-close-btn" onclick="showVendas()" title="Fechar">‚úï</button>
  <div class="apps-header">
    <div class="apps-icon"></div>
    <h2>Torne sua experi√™ncia no eNotas ainda mais incr√≠vel com a ajuda de apps que voc√™ vai adorar</h2>
    <p>Exibindo os apps de <a href="#">todas as categorias</a></p>
  </div>

  <div class="apps-grid">
    <div class="app-card">
      <div class="app-card-header">
        <div class="app-info">
          <h3>Hotmart</h3>
          <p>Canal de venda</p>
        </div>
        <div class="app-logo">
          <svg width="50" height="50" viewBox="0 0 50 50">
            <circle cx="25" cy="25" r="25" fill="#ff6b35"/>
            <path d="M15 20h20v3H15zm0 7h20v3H15z" fill="#fff"/>
          </svg>
        </div>
      </div>
      <button class="btn-ativar-app" id="btnAtivarHotmart" onclick="openIntegracaoModal()">Ativar</button>
    </div>
  </div>
</div>

<!-- Modal de Integra√ß√£o Hotmart -->
<div id="integracaoModal" class="integracao-modal">
  <div class="integracao-content">
    <div class="integracao-header">
      <div class="integracao-logo">üî•</div>
      <h3 style="margin: 0; font-size: 18px; color: #333;">Hotmart</h3>
    </div>
    <div class="integracao-body">
      <div class="integracao-form">
        <div class="form-help" style="margin-bottom: 16px;">
          Caso tenha d√∫vidas ao realizar a integra√ß√£o, siga este <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35773432368909--Hotmart-Como-habilitar-a-integra%C3%A7%C3%A3o-na-eNotas" target="_blank" rel="noopener">artigo</a>.
          <br>
          <button class="visualizar-btn" id="btnPreVisualizar" onclick="showPassosIntegracao()">Pr√©-visualizar</button>
        </div>
        <div class="form-group">
          <label>E-mail</label>
          <input type="email" placeholder="seu@email.com" />
        </div>
        <div class="form-group">
          <label>Hottok</label>
          <input type="text" placeholder="Cole aqui seu token" />
        </div>
      </div>
      
      <div class="form-group" style="margin-top: 16px;">
          <button type="button" onclick="openImportacaoModal(event)" style="width: 100%; padding: 12px; background: #1abc9c; color: #fff; border: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; transition: background 0.2s;">
            üì• Importar vendas
          </button>
         <div class="integracao-actions">
      <button class="btn-cancelar" id="btnCancelarIntegracao" onclick="closeIntegracaoModal()">Cancelar</button>
      <button class="btn-salvar" id="btnSalvarIntegracao" onclick="salvarIntegracao()">Salvar</button>
    </div>
  </div>
</div>
            </div>
      </div>
    </div>
   

         </div>
           </div>
           </div>
  

<!-- Chatbot flutuante -->
<div class="chatbot-bubble" id="chatbotBubble" onclick="toggleChatbot()">
  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 2C6.48 2 2 6.48 2 12c0 1.54.36 3 .97 4.29L2 22l5.71-.97C9 21.64 10.46 22 12 22c5.52 0 10-4.48 10-10S17.52 2 12 2zm0 18c-1.38 0-2.67-.3-3.83-.85l-.27-.13-2.82.48.48-2.82-.13-.27C4.3 14.67 4 13.38 4 12c0-4.41 3.59-8 8-8s8 3.59 8 8-3.59 8-8 8z"/>
    <circle cx="9" cy="12" r="1"/>
    <circle cx="12" cy="12" r="1"/>
    <circle cx="15" cy="12" r="1"/>
  </svg>
</div>

<div class="chatbot-window" id="chatbotWindow">
  <div class="chatbot-header">
    <h3>üí¨ Assistente eNotas</h3>
    <button class="chatbot-close" onclick="toggleChatbot()">‚úï</button>
  </div>
  <div class="chatbot-messages" id="chatbotMessages">
    <div class="chat-message bot">
      <div class="message-bubble">
        Ol√°! üëã Sou o assistente virtual do eNotas. Como posso ajudar voc√™ hoje?
      </div>
    </div>
  </div>
  <div class="chatbot-input">
    <input type="text" id="chatInput" placeholder="Digite sua mensagem..." onkeypress="handleChatKeyPress(event)">
    <button onclick="sendChatMessage()">Enviar</button>
  </div>
</div>

<div id="infoModal" aria-label="Popup de conte√∫do" style="display:none;"></div>

<script>
// ============================================
// FUN√á√ïES DE NAVEGA√á√ÉO E MODAIS - NO ESCOPO GLOBAL
// ============================================

window.showVendas = function() {
  const vendasPage = document.getElementById('vendasPage');
  const appsPage = document.getElementById('appsPage');
  
  if (vendasPage) vendasPage.style.display = 'block';
  if (appsPage) {
    appsPage.classList.remove('active');
    appsPage.style.display = 'none';
  }
  
  document.querySelectorAll('.menu-item').forEach(item => {
    item.classList.remove('active');
  });
  
  const vendasMenuItem = document.querySelector('.menu-item');
  if (vendasMenuItem) vendasMenuItem.classList.add('active');
};

window.showApps = function() {
  const vendasPage = document.getElementById('vendasPage');
  const appsPage = document.getElementById('appsPage');
  
  if (vendasPage) vendasPage.style.display = 'none';
  if (appsPage) {
    appsPage.classList.add('active');
    appsPage.style.display = 'block';
  }
  
  document.querySelectorAll('.menu-item').forEach(item => {
    item.classList.remove('active');
  });
};

window.openIntegracaoModal = function() {
  const modal = document.getElementById('integracaoModal');
  if (modal) {
    modal.classList.add('open');
    modal.style.display = 'flex';
  }
};

window.closeIntegracaoModal = function() {
  const modal = document.getElementById('integracaoModal');
  if (modal) {
    modal.classList.remove('open');
    modal.style.display = 'none';
  }
};

window.salvarIntegracao = function() {
  alert('Integra√ß√£o salva com sucesso! ‚úÖ');
  window.closeIntegracaoModal();
};
  
window.salvarIntegracao = function() {
  alert('Integra√ß√£o salva com sucesso! ‚úÖ');
  window.closeIntegracaoModal();
};
  
window.openImportacaoModal = function(event) {
  if (event) {
    event.preventDefault();
    event.stopPropagation();
  }
  const modal = document.getElementById('importacaoVendasModal');
  if (modal) {
    modal.classList.add('open');
    modal.style.display = 'flex';
    
    // Define data padr√£o (√∫ltimos 30 dias)
    const hoje = new Date();
    const umMesAtras = new Date(hoje);
    umMesAtras.setDate(hoje.getDate() - 30);
    
    const dataFimInput = document.getElementById('dataFimImport');
    const dataInicioInput = document.getElementById('dataInicioImport');
    
    if (dataFimInput) dataFimInput.valueAsDate = hoje;
    if (dataInicioInput) dataInicioInput.valueAsDate = umMesAtras;
  }
};

window.closeImportacaoModal = function() {
  const modal = document.getElementById('importacaoVendasModal');
  if (modal) {
    modal.classList.remove('open');
    modal.style.display = 'none';
  }
};

window.processarImportacao = function() {
  const dataInicio = document.getElementById('dataInicioImport').value;
  const dataFim = document.getElementById('dataFimImport').value;
  const emissao = document.querySelector('input[name="emissao"]:checked').value;
  const enviar = document.querySelector('input[name="enviar"]:checked').value;
  
  if (!dataInicio || !dataFim) {
    alert('‚ö†Ô∏è Por favor, preencha o per√≠odo da importa√ß√£o!');
    return;
  }
  
  const dataInicioObj = new Date(dataInicio);
  const dataFimObj = new Date(dataFim);
  
  if (dataInicioObj > dataFimObj) {
    alert('‚ö†Ô∏è A data inicial n√£o pode ser maior que a data final!');
    return;
  }
  
  let mensagemEmissao = '';
  if (emissao === 'nao') {
    mensagemEmissao = 'As vendas ser√£o importadas sem emiss√£o de notas fiscais.';
  } else if (emissao === 'apos') {
    mensagemEmissao = 'As notas fiscais ser√£o emitidas automaticamente ap√≥s o per√≠odo de garantia.';
  } else {
    mensagemEmissao = 'As notas fiscais ser√£o emitidas imediatamente.';
  }
  
  const mensagemEnvio = enviar === 'sim' 
    ? 'As notas ser√£o enviadas por e-mail para os clientes.' 
    : 'As notas n√£o ser√£o enviadas automaticamente.';
  
  alert(`‚úÖ Importa√ß√£o iniciada!\n\nPer√≠odo: ${dataInicio} at√© ${dataFim}\n${mensagemEmissao}\n${mensagemEnvio}\n\nVoc√™ receber√° uma notifica√ß√£o quando a importa√ß√£o for conclu√≠da.`);
  
  window.closeImportacaoModal();
};  

window.showPassosIntegracao = function() {
  const overlay = document.createElement('div');
  overlay.className = 'inlinePopupBackdrop';
  overlay.style.position = 'fixed';
  overlay.style.inset = '0';
  overlay.style.background = 'rgba(0,0,0,.5)';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  overlay.style.zIndex = '10001';

  const content = document.createElement('div');
  content.className = 'inlinePopupContent';
  content.style.width = 'min(720px, 92%)';
  content.style.maxHeight = '75vh';
  content.style.overflow = 'auto';
  content.style.background = '#fff';
  content.style.borderRadius = '8px';
  content.style.padding = '24px';
  content.style.position = 'relative';

  const closeBtn = document.createElement('button');
  closeBtn.textContent = '‚úñ';
  closeBtn.style.position = 'absolute';
  closeBtn.style.top = '12px';
  closeBtn.style.right = '12px';
  closeBtn.style.width = '28px';
  closeBtn.style.height = '28px';
  closeBtn.style.border = 'none';
  closeBtn.style.background = 'transparent';
  closeBtn.style.color = '#666';
  closeBtn.style.fontSize = '18px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.addEventListener('click', () => document.body.removeChild(overlay));

  const title = document.createElement('h3');
  title.style.margin = '0 0 20px';
  title.style.fontSize = '20px';
  title.style.color = '#333';
  title.textContent = 'Passo a Passo - Integra√ß√£o Hotmart';

  const passos = document.createElement('div');
  passos.style.fontSize = '14px';
  passos.style.lineHeight = '1.8';
  passos.style.color = '#555';
  passos.innerHTML = `
    <ol style="padding-left: 20px;">
      <li><strong>Acesse sua conta Hotmart:</strong> Entre no painel da Hotmart com suas credenciais.</li>
      <li><strong>V√° em Ferramentas:</strong> No menu lateral, clique em "Ferramentas".</li>
      <li><strong>Acesse Webhook:</strong> Busque pela op√ß√£o "Webhook" e clique nela.</li>
      <li><strong>Copie o URL do Webhook:</strong> Voc√™ ver√° um campo com a URL do webhook.</li>
      <li><strong>Cole no eNotas:</strong> Volte para o eNotas e cole a URL no campo indicado.</li>
      <li><strong>Configure o Token:</strong> Na Hotmart, procure por "Token de acesso" ou "Hottok".</li>
      <li><strong>Gere um novo token:</strong> Clique em "Gerar novo token" se necess√°rio.</li>
      <li><strong>Copie o token:</strong> Copie o c√≥digo do token gerado.</li>
      <li><strong>Cole no eNotas:</strong> Retorne ao eNotas e cole no campo "Hottok".</li>
      <li><strong>Informe seu e-mail:</strong> Digite o e-mail cadastrado na Hotmart.</li>
      <li><strong>Verifique os dados:</strong> Confira se todos os campos est√£o preenchidos corretamente.</li>
      <li><strong>Salve a integra√ß√£o:</strong> Clique no bot√£o "Salvar" no eNotas.</li>
      <li><strong>Aguarde a confirma√ß√£o:</strong> O sistema validar√° os dados inseridos.</li>
      <li><strong>Teste a integra√ß√£o:</strong> Fa√ßa uma venda teste na Hotmart.</li>
      <li><strong>Verifique no eNotas:</strong> Confira se a venda apareceu no painel de vendas.</li>
      <li><strong>Configure produtos:</strong> Ajuste as configura√ß√µes de produtos conforme necess√°rio.</li>
      <li><strong>Ative a emiss√£o autom√°tica:</strong> Habilite a emiss√£o autom√°tica de notas fiscais.</li>
      <li><strong>Pronto!</strong> Sua integra√ß√£o est√° completa e funcionando.</li>
    </ol>
  `;

  content.appendChild(closeBtn);
  content.appendChild(title);
  content.appendChild(passos);
  overlay.appendChild(content);
  document.body.appendChild(overlay);
};

// Aliases sem window. para compatibilidade
const showVendas = window.showVendas;
const showApps = window.showApps;
const openIntegracaoModal = window.openIntegracaoModal;
const closeIntegracaoModal = window.closeIntegracaoModal;
const salvarIntegracao = window.salvarIntegracao;
const showPassosIntegracao = window.showPassosIntegracao;
</script>

<script>
const allVendas = [
  {data:'07/10/2025', produto:'Curso de Gest√£o Empresarial', cliente:'Maria Oliveira', valor:'R$ 199,00', nota:'Erro', venda:'erro', canal:'Venda Manual'},
  {data:'06/10/2025', produto:'Imers√£o Mestres da Audi√™ncia', cliente:'Leila Carvalho', valor:'R$ 42,90', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'06/10/2025', produto:'Imers√£o Mestres da Audi√™ncia', cliente:'Francisco Helton', valor:'R$ 42,90', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'06/10/2025', produto:'Mentoria Avan√ßada', cliente:'Gisele Montalli', valor:'R$ 150,00', nota:'Pendente', venda:'em garantia', canal:'Venda Manual'},
  {data:'05/10/2025', produto:'Workshop Digital', cliente:'Marcos Silva', valor:'R$ 99,90', nota:'Pendente', venda:'em garantia', canal:'Venda Manual'},
  {data:'04/10/2025', produto:'Curso de Copywriting', cliente:'Ana Pereira', valor:'R$ 79,00', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'03/10/2025', produto:'Trilha de Sucesso', cliente:'Bruno Costa', valor:'R$ 59,00', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'02/10/2025', produto:'Mentoria Express', cliente:'Jo√£o Mendes', valor:'R$ 120,00', nota:'Pendente', venda:'em garantia', canal:'Venda Manual'},
  {data:'01/10/2025', produto:'Programa Premium', cliente:'Patr√≠cia Lima', valor:'R$ 249,00', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'30/09/2025', produto:'Curso Avan√ßado', cliente:'Ricardo Alves', valor:'R$ 89,00', nota:'Pendente', venda:'em garantia', canal:'Venda Manual'},
  {data:'29/09/2025', produto:'Treinamento Pro', cliente:'Carla Nunes', valor:'R$ 129,00', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'28/09/2025', produto:'Curso de SEO', cliente:'Thiago Lima', valor:'R$ 110,00', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'27/09/2025', produto:'Webinar Avan√ßado', cliente:'Lucas Ramos', valor:'R$ 55,00', nota:'Pendente', venda:'em garantia', canal:'Venda Manual'}
];

let paginaAtual = 1;
let linhasPorPagina = 4;

let filtros = {
  dataInicio: '',
  dataFim: '',
  cliente: '',
  produto: '',
  canal: '',
  status: ''
};

function normalizeDate(d) {
  if (!d) return '';
  const dt = new Date(d);
  if (isNaN(dt)) return '';
  return dt.toISOString().split('T')[0];
}

function aplicarFiltros(lista) {
  const v = lista || allVendas;
  const sIni = filtros.dataInicio ? new Date(filtros.dataInicio) : null;
  const sFim = filtros.dataFim ? new Date(filtros.dataFim) : null;
  return v.filter(x => {
    if (sIni || sFim) {
      const dt = new Date(x.data);
      if (sIni && dt < sIni) return false;
      if (sFim && dt > sFim) return false;
    }
    if (filtros.cliente && !x.cliente.toLowerCase().includes(filtros.cliente.toLowerCase())) return false;
    if (filtros.produto && !x.produto.toLowerCase().includes(filtros.produto.toLowerCase())) return false;
    if (filtros.canal && x.canal !== filtros.canal) return false;
    if (filtros.status && x.nota !== filtros.status) return false;
    return true;
  });
}

function renderTabela() {
  const tabela = document.getElementById("tabelaVendas");
  tabela.innerHTML = "";

  const dadosFiltrados = aplicarFiltros(allVendas);
  const total = dadosFiltrados.length;
  const maxPag = Math.max(1, Math.ceil(total / linhasPorPagina));
  if (paginaAtual > maxPag) paginaAtual = maxPag;

  const inicio = (paginaAtual - 1) * linhasPorPagina;
  const fim = inicio + linhasPorPagina;
  const paginadas = dadosFiltrados.slice(inicio, fim);

  paginadas.forEach((v, idx) => {
    const tr = document.createElement("tr");
    const globalIndex = inicio + idx;

    const checkbox = `<td class="checkboxCol" style="text-align:center;">
      <input type="checkbox" class="rowSel" data-id="${globalIndex}">
    </td>`;

    let notaHTML = "";
    if (v.nota === "Emitida") {
      notaHTML = `<span class='badge emitida'>
        <span class="tooltip" aria-label="Emitida">
          üñ®Ô∏è
          <span class="tooltiptext">emitida</span>
        </span>
      </span>`;
    } else if (v.nota === "Erro") {
      notaHTML = `<span class='badge erro'>
        <span class="tooltip" aria-label="Erro">
          ‚ùó
          <span class="tooltiptext">emiss√£o negada</span>
        </span>
      </span>`;
    } else {
      notaHTML = `<span class='badge pendente'>
        <span class="tooltip" aria-label="Pendente">
          ‚è≥
          <span class="tooltiptext">pendente</span>
        </span>
      </span>`;
    }

    const acoesHTML = v.nota === 'Emitida' 
      ? `<button class='btn-acao' onclick='openNotaModal()'>Visualizar</button>`
      : v.nota === 'Erro'
      ? `<button class='btn-acao' onclick='showErroMessage()'>Visualizar</button>`
      : `<button class='btn-acao' onclick='showPendenteMessage()'>Visualizar</button>`;

    tr.innerHTML = `
      ${checkbox}
      <td>${v.data}</td>
      <td>${v.produto}</td>
      <td>${v.cliente}</td>
      <td>${v.valor}</td>
      <td>${notaHTML}</td>
      <td>${v.canal}</td>
      <td>${acoesHTML}</td>
    `;
    tabela.appendChild(tr);
  });

  const paginaInfo = document.getElementById("paginaInfo");
  if (paginaInfo) paginaInfo.textContent = `P√°gina ${paginaAtual} de ${maxPag}`;

  const paginaSel = document.getElementById("paginaSelector");
  if (paginaSel) {
    paginaSel.innerHTML = "";
    for (let i = 1; i <= maxPag; i++) {
      const opt = document.createElement("option");
      opt.value = i;
      opt.text = String(i);
      if (i === paginaAtual) opt.selected = true;
      paginaSel.appendChild(opt);
    }
  }

  const btnAnterior = document.getElementById("btnAnterior");
  const btnProximo = document.getElementById("btnProximo");
  if (btnAnterior) btnAnterior.disabled = (paginaAtual <= 1);
  if (btnProximo) btnProximo.disabled = (paginaAtual >= maxPag);
}

function anterior() {
  const maxPag = Math.max(1, Math.ceil(aplicarFiltros(allVendas).length / linhasPorPagina));
  if (paginaAtual > 1) {
    paginaAtual--;
    function showPassosIntegracao() {
  const overlay = document.createElement('div');
  overlay.className = 'inlinePopupBackdrop';
  overlay.style.position = 'fixed';
  overlay.style.inset = '0';
  overlay.style.background = 'rgba(0,0,0,.5)';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  overlay.style.zIndex = '10001';

  const content = document.createElement('div');
  content.className = 'inlinePopupContent';
  content.style.width = 'min(720px, 92%)';
  content.style.maxHeight = '75vh';
  content.style.overflow = 'auto';
  content.style.background = '#fff';
  content.style.borderRadius = '8px';
  content.style.padding = '24px';
  content.style.position = 'relative';

  const closeBtn = document.createElement('button');
  closeBtn.textContent = '‚úñ';
  closeBtn.style.position = 'absolute';
  closeBtn.style.top = '12px';
  closeBtn.style.right = '12px';
  closeBtn.style.width = '28px';
  closeBtn.style.height = '28px';
  closeBtn.style.border = 'none';
  closeBtn.style.background = 'transparent';
  closeBtn.style.color = '#666';
  closeBtn.style.fontSize = '18px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.addEventListener('click', () => document.body.removeChild(overlay));

  const title = document.createElement('h3');
  title.style.margin = '0 0 20px';
  title.style.fontSize = '20px';
  title.style.color = '#333';
  title.textContent = 'Passo a Passo - Integra√ß√£o Hotmart';

  const passos = document.createElement('div');
  passos.style.fontSize = '14px';
  passos.style.lineHeight = '1.8';
  passos.style.color = '#555';
  passos.innerHTML = `
    <ol style="padding-left: 20px;">
      <li><strong>Acesse sua conta Hotmart:</strong> Entre no painel da Hotmart com suas credenciais.</li>
      <li><strong>V√° em Ferramentas:</strong> No menu lateral, clique em "Ferramentas".</li>
      <li><strong>Acesse Webhook:</strong> Busque pela op√ß√£o "Webhook" e clique nela.</li>
      <li><strong>Copie o URL do Webhook:</strong> Voc√™ ver√° um campo com a URL do webhook.</li>
      <li><strong>Cole no eNotas:</strong> Volte para o eNotas e cole a URL no campo indicado.</li>
      <li><strong>Configure o Token:</strong> Na Hotmart, procure por "Token de acesso" ou "Hottok".</li>
      <li><strong>Gere um novo token:</strong> Clique em "Gerar novo token" se necess√°rio.</li>
      <li><strong>Copie o token:</strong> Copie o c√≥digo do token gerado.</li>
      <li><strong>Cole no eNotas:</strong> Retorne ao eNotas e cole no campo "Hottok".</li>
      <li><strong>Informe seu e-mail:</strong> Digite o e-mail cadastrado na Hotmart.</li>
      <li><strong>Verifique os dados:</strong> Confira se todos os campos est√£o preenchidos corretamente.</li>
      <li><strong>Salve a integra√ß√£o:</strong> Clique no bot√£o "Salvar" no eNotas.</li>
      <li><strong>Aguarde a confirma√ß√£o:</strong> O sistema validar√° os dados inseridos.</li>
      <li><strong>Teste a integra√ß√£o:</strong> Fa√ßa uma venda teste na Hotmart.</li>
      <li><strong>Verifique no eNotas:</strong> Confira se a venda apareceu no painel de vendas.</li>
      <li><strong>Configure produtos:</strong> Ajuste as configura√ß√µes de produtos conforme necess√°rio.</li>
      <li><strong>Ative a emiss√£o autom√°tica:</strong> Habilite a emiss√£o autom√°tica de notas fiscais.</li>
      <li><strong>Pronto!</strong> Sua integra√ß√£o est√° completa e funcionando.</li>
    </ol>
  `;

  content.appendChild(closeBtn);
  content.appendChild(title);
  content.appendChild(passos);
  overlay.appendChild(content);
  document.body.appendChild(overlay);
}

function showVendas() {
  const vendasPage = document.getElementById('vendasPage');
  const appsPage = document.getElementById('appsPage');
  
  if (vendasPage) vendasPage.style.display = 'block';
  if (appsPage) appsPage.classList.remove('active');
  
  document.querySelectorAll('.menu-item').forEach(item => {
    item.classList.remove('active');
  });
  
  const vendasMenuItem = document.querySelector('.menu-item');
  if (vendasMenuItem) vendasMenuItem.classList.add('active');
}

function showApps() {
  const vendasPage = document.getElementById('vendasPage');
  const appsPage = document.getElementById('appsPage');
  
  console.log('showApps chamado');
  console.log('vendasPage:', vendasPage);
  console.log('appsPage:', appsPage);
  
  if (vendasPage) {
    vendasPage.style.display = 'none';
    console.log('vendasPage escondido');
  }
  if (appsPage) {
    appsPage.classList.add('active');
    appsPage.style.display = 'block';
    console.log('appsPage mostrado');
  }
  
  document.querySelectorAll('.menu-item').forEach(item => {
    item.classList.remove('active');
  });
}

function showSubmenu(event) {
  // Submenu j√° aparece via CSS :hover
}

function hideSubmenu(event) {
  // Submenu j√° desaparece via CSS
}

function openIntegracaoModal() {
  const modal = document.getElementById('integracaoModal');
  console.log('openIntegracaoModal chamado');
  console.log('modal:', modal);
  if (modal) {
    modal.classList.add('open');
    modal.style.display = 'flex';
    console.log('Modal aberto');
  }
}

function closeIntegracaoModal() {
  const modal = document.getElementById('integracaoModal');
  if (modal) {
    modal.classList.remove('open');
    modal.style.display = 'none';
  }
}

function salvarIntegracao() {
  alert('Integra√ß√£o salva com sucesso! ‚úÖ');
  closeIntegracaoModal();
}

renderTabela();
updateXVisibility();
    
    function minimizarBanner(id, event) {
  if (event) {
    event.stopPropagation();
    event.preventDefault();
  }
  
  const banner = document.getElementById(id);
  if (!banner) return;
  
  banner.classList.remove('expandido');
  banner.classList.add('minimizado');
  updateXVisibility();
}

function restaurarBanner(id, event) {
  const banner = document.getElementById(id);
  if (!banner) return;
  
  // S√≥ restaura se estiver minimizado e o clique for no banner
  if (banner.classList.contains('minimizado')) {
    if (event) {
      event.stopPropagation();
      event.preventDefault();
    }
    banner.classList.remove('minimizado');
    updateXVisibility();
  }
}

  }
}

function proxima() {
  const maxPag = Math.max(1, Math.ceil(aplicarFiltros(allVendas).length / linhasPorPagina));
  if (paginaAtual < maxPag) {
    paginaAtual++;
    renderTabela();
  }
}

function goToPage(p) {
  const page = parseInt(p, 10);
  const maxPag = Math.max(1, Math.ceil(aplicarFiltros(allVendas).length / linhasPorPagina));
  if (page >= 1 && page <= maxPag) {
    paginaAtual = page;
    renderTabela();
  }
}

function toggleAcoesDropdown() {
  const dd = document.getElementById("acoesDropdown");
  dd.style.display = dd.style.display === "block" ? "none" : "block";
}
function handleAcoes(action) {
  alert("A√ß√£o em massa: " + action);
  document.getElementById("acoesDropdown").style.display = "none";
}

function toggleFiltroPanel() {
  const panel = document.getElementById("filtrosPanel");
  panel.style.display = panel.style.display === "block" ? "none" : "block";
}
function applyFiltersFromUI() {
  filtros.dataInicio = document.getElementById("fDataInicio").value;
  filtros.dataFim = document.getElementById("fDataFim").value;
  filtros.cliente = document.getElementById("fCliente").value;
  filtros.produto = document.getElementById("fProduto").value;
  filtros.canal = document.getElementById("fCanal").value;
  filtros.status = document.getElementById("fStatus").value;
  paginaAtual = 1;
  renderTabela();
  toggleFiltroPanel();
}
function clearFilters() {
  document.getElementById("fDataInicio").value = "";
  document.getElementById("fDataFim").value = "";
  document.getElementById("fCliente").value = "";
  document.getElementById("fProduto").value = "";
  document.getElementById("fCanal").value = "";
  document.getElementById("fStatus").value = "";
  filtros = { dataInicio:'', dataFim:'', cliente:'', produto:'', canal:'', status:'' };
  paginaAtual = 1;
  renderTabela();
}
function refreshFiltersOnInput() {
  applyFiltersFromUI();
}

document.addEventListener('click', (e) => {
  const acoesBox = document.querySelector('.acoes');
  const targetInsideAcoes = acoesBox.contains(e.target);
  const filtrosPanel = document.getElementById('filtrosPanel');
  if (!targetInsideAcoes && filtrosPanel && !filtrosPanel.contains(e.target)) {
    filtrosPanel.style.display = 'none';
  }
});

function openCertModal(event) {
  if (event) event.preventDefault();
  document.getElementById('certModal').classList.add('modalVisible');
  document.getElementById('certModal').style.display = 'flex';
}
function closeCertModal() {
  document.getElementById('certModal').classList.remove('modalVisible');
  document.getElementById('certModal').style.display = 'none';
}
function concluirCertModal() {
  closeCertModal();
}

function openProductInfoPopup() {
  const overlay = document.createElement('div');
  overlay.className = 'inlinePopupBackdrop';
  overlay.style.position = 'fixed';
  overlay.style.inset = '0';
  overlay.style.background = 'rgba(0,0,0,.45)';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  overlay.style.zIndex = '9999';

  const content = document.createElement('div');
  content.className = 'inlinePopupContent';
  content.style.width = 'min(720px, 92%)';
  content.style.maxHeight = '60vh';
  content.style.overflow = 'auto';
  content.style.background = '#fff';
  content.style.borderRadius = '6px';
  content.style.padding = '20px';
  content.style.position = 'relative';

  const closeBtn = document.createElement('button');
  closeBtn.className = 'inlinePopupClose';
  closeBtn.textContent = '‚úñ';
  closeBtn.style.position = 'absolute';
  closeBtn.style.top = '6px';
  closeBtn.style.right = '8px';
  closeBtn.style.width = '20px';
  closeBtn.style.height = '20px';
  closeBtn.style.border = 'none';
  closeBtn.style.background = 'transparent';
  closeBtn.style.color = '#333';
  closeBtn.style.fontSize = '12px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.opacity = '0.25';
  closeBtn.addEventListener('mouseenter', () => closeBtn.style.opacity = '0.85');
  closeBtn.addEventListener('mouseleave', () => closeBtn.style.opacity = '0.25');
  closeBtn.addEventListener('click', () => document.body.removeChild(overlay));

  const p = document.createElement('p');
  p.style.margin = '0';
  p.style.fontSize = '14px';
  p.style.lineHeight = '1.5';
  p.style.color = '#333';
  p.innerHTML = `Com a nova funcionalidade do eNotas, voc√™ pode configurar o tipo de nota fiscal padr√£o para seus produtos f√≠sicos vendidos na Hotmart. Isso significa que ao cadastrar novos produtos f√≠sicos na plataforma, eles j√° vir√£o automaticamente com o tipo de nota fiscal correto (NFe - Nota Fiscal Eletr√¥nica). Essa configura√ß√£o facilita o processo de emiss√£o de notas para produtos f√≠sicos, garantindo que voc√™ esteja em conformidade fiscal desde o in√≠cio. A integra√ß√£o entre Hotmart e eNotas permite que todo o processo seja automatizado, desde a venda at√© a emiss√£o e envio da nota fiscal para o cliente. Para maiores informa√ß√µes, veja o <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/39949977411085--Produto-F%C3%ADsico-Como-configurar-o-tipo-de-nota-padr%C3%A3o-para-novos-produtos-f%C3%ADsicos-na-eNotas" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">artigo</a>.`;

  content.appendChild(closeBtn);
  content.appendChild(p);
  overlay.appendChild(content);
  document.body.appendChild(overlay);
}

function openInlineMessage(message, link) {
  const overlay = document.createElement('div');
  overlay.className = 'inlinePopupBackdrop';
  overlay.style.position = 'fixed';
  overlay.style.inset = '0';
  overlay.style.background = 'rgba(0,0,0,.45)';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  overlay.style.zIndex = '9999';

  const content = document.createElement('div');
  content.className = 'inlinePopupContent';
  content.style.width = 'min(720px, 92%)';
  content.style.maxHeight = '60vh';
  content.style.overflow = 'auto';
  content.style.background = '#fff';
  content.style.borderRadius = '6px';
  content.style.padding = '16px';
  content.style.position = 'relative';

  const closeBtn = document.createElement('button');
  closeBtn.className = 'inlinePopupClose';
  closeBtn.textContent = '‚úñ';
  closeBtn.style.position = 'absolute';
  closeBtn.style.top = '6px';
  closeBtn.style.right = '8px';
  closeBtn.style.width = '20px';
  closeBtn.style.height = '20px';
  closeBtn.style.border = 'none';
  closeBtn.style.background = 'transparent';
  closeBtn.style.color = '#333';
  closeBtn.style.fontSize = '12px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.opacity = '0.25';
  closeBtn.addEventListener('mouseenter', () => closeBtn.style.opacity = '0.85');
  closeBtn.addEventListener('mouseleave', () => closeBtn.style.opacity = '0.25');
  closeBtn.addEventListener('click', () => document.body.removeChild(overlay));

  const p = document.createElement('p');
  p.style.margin = '0';
  p.style.fontSize = '14px';
  p.style.lineHeight = '1.5';
  p.style.color = '#333';
  
  if (link) {
    const messageWithLink = message.replace(
      'clique aqui',
      `<a href="${link}" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">clique aqui</a>`
    );
    p.innerHTML = messageWithLink;
  } else {
    p.innerHTML = message;
  }

  content.appendChild(closeBtn);
  content.appendChild(p);
  overlay.appendChild(content);
  document.body.appendChild(overlay);
}

function openInlineContent(url) {
  let container = document.getElementById('infoModal');
  if (!container) {
    container = document.createElement('div');
    container.id = 'infoModal';
    document.body.appendChild(container);
  }

  container.innerHTML = `
    <div class="infoModalBackdrop" onclick="closeInfoModal()" style="position:fixed; inset:0; background:rgba(0,0,0,.45); display:flex; align-items:center; justify-content:center; z-index:999;">
      <div class="infoModalContent" onclick="event.stopPropagation()" style="width: min(800px, 90%); background:#fff; border-radius:6px; padding:12px; position:relative;">
        <button class="infoModalClose" onclick="closeInfoModal()" aria-label="Fechar" style="position:absolute; top:6px; right:6px; border:none; background:#f1f1f1; border-radius:4px; padding:6px 8px; cursor:pointer;">‚úñ</button>
        <iframe class="infoModalFrame" src="${url}" frameborder="0" title="Conte√∫do" style="width:100%; height:420px;"></iframe>
      </div>
    </div>
  `;
  container.style.display = 'block';
}
function closeInfoModal() {
  const container = document.getElementById('infoModal');
  if (container) container.style.display = 'none';
  if (container) container.innerHTML = '';
}

function expandirBanner(id) {
  const banner = document.getElementById(id);
  if (!banner) return;
  const already = banner.classList.contains('expandido');

  document.querySelectorAll('.banner.expandido').forEach(b => {
    if (b.id !== id) b.classList.remove('expandido');
  });

  if (!already) {
    banner.classList.add('expandido');
  } else {
    banner.classList.remove('expandido');
  }

  updateXVisibility();
}
  
  

function fecharBanner(id) {
  const banner = document.getElementById(id);
  if (!banner) return;
  banner.classList.remove('expandido');
  updateXVisibility();
}

function updateXVisibility() {
  document.querySelectorAll('.banner').forEach(b => {
    const btn = b.querySelector('.fechar-internal');
    if (!btn) return;
    if (b.classList.contains('expandido')) {
      btn.style.display = 'inline-flex';
    } else {
      btn.style.display = 'none';
    }
  });
}
  
  window.minimizarBanner = function(id, event) {
  if (event) {
    event.stopPropagation();
    event.preventDefault();
  }
  
  const banner = document.getElementById(id);
  if (!banner) return;
  
  banner.classList.remove('expandido');
  banner.classList.add('minimizado');
  updateXVisibility();
};

window.restaurarBanner = function(id, event) {
  const banner = document.getElementById(id);
  if (!banner) return;
  
  if (banner.classList.contains('minimizado')) {
    if (event) {
      event.stopPropagation();
      event.preventDefault();
    }
    banner.classList.remove('minimizado');
    updateXVisibility();
  }
};

function openNotasNaoEmitidasPopup() {
  const overlay = document.createElement('div');
  overlay.className = 'inlinePopupBackdrop';
  overlay.style.position = 'fixed';
  overlay.style.inset = '0';
  overlay.style.background = 'rgba(0,0,0,.45)';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  overlay.style.zIndex = '9999';

  const content = document.createElement('div');
  content.className = 'inlinePopupContent';
  content.style.width = 'min(900px, 92%)';
  content.style.maxHeight = '70vh';
  content.style.overflow = 'auto';
  content.style.background = '#fff';
  content.style.borderRadius = '6px';
  content.style.padding = '20px';
  content.style.position = 'relative';

  const closeBtn = document.createElement('button');
  closeBtn.className = 'inlinePopupClose';
  closeBtn.textContent = '‚úñ';
  closeBtn.style.position = 'absolute';
  closeBtn.style.top = '6px';
  closeBtn.style.right = '8px';
  closeBtn.style.width = '20px';
  closeBtn.style.height = '20px';
  closeBtn.style.border = 'none';
  closeBtn.style.background = 'transparent';
  closeBtn.style.color = '#333';
  closeBtn.style.fontSize = '12px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.opacity = '0.25';
  closeBtn.addEventListener('mouseenter', () => closeBtn.style.opacity = '0.85');
  closeBtn.addEventListener('mouseleave', () => closeBtn.style.opacity = '0.25');
  closeBtn.addEventListener('click', () => document.body.removeChild(overlay));

  const title = document.createElement('h3');
  title.style.margin = '0 0 16px';
  title.style.fontSize = '18px';
  title.style.color = '#333';
  title.textContent = 'Notas Fiscais N√£o Emitidas';

  const alertMsg = document.createElement('p');
  alertMsg.style.margin = '0 0 12px';
  alertMsg.style.padding = '12px';
  alertMsg.style.background = '#fff3cd';
  alertMsg.style.border = '1px solid #ffc107';
  alertMsg.style.borderRadius = '6px';
  alertMsg.style.fontSize = '14px';
  alertMsg.style.color = '#856404';
  alertMsg.innerHTML = '<strong>‚ö†Ô∏è Aten√ß√£o:</strong> Voc√™ possui 20 notas fiscais pendentes de emiss√£o.';

  const table = document.createElement('table');
  table.className = 'notas-table';
  table.innerHTML = `
    <thead>
      <tr>
        <th>Data</th>
        <th>Produto</th>
        <th>Cliente</th>
        <th>Valor total</th>
        <th>A√ß√£o</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>24/09/2025</td>
        <td>Imers√£o Mestres da Audi√™ncia...</td>
        <td>Felipe Poppe</td>
        <td>R$ 39,90</td>
        <td><button class="btn-corrigir" onclick="openCorrigirPopup()">Corrigir</button></td>
      </tr>
      <tr>
        <td>23/09/2025</td>
        <td>Curso de Marketing Digital</td>
        <td>Ana Silva</td>
        <td>R$ 149,00</td>
        <td><button class="btn-corrigir" onclick="openCorrigirPopup()">Corrigir</button></td>
      </tr>
      <tr>
        <td>22/09/2025</td>
        <td>Mentoria Premium</td>
        <td>Carlos Santos</td>
        <td>R$ 299,00</td>
        <td><button class="btn-corrigir" onclick="openCorrigirPopup()">Corrigir</button></td>
      </tr>
      <tr>
        <td>21/09/2025</td>
        <td>Workshop de Vendas</td>
        <td>Mariana Costa</td>
        <td>R$ 89,90</td>
        <td><button class="btn-corrigir" onclick="openCorrigirPopup()">Corrigir</button></td>
      </tr>
      <tr>
        <td>20/09/2025</td>
        <td>Treinamento Avan√ßado</td>
        <td>Roberto Lima</td>
        <td>R$ 199,00</td>
        <td><button class="btn-corrigir" onclick="openCorrigirPopup()">Corrigir</button></td>
      </tr>
    </tbody>
  `;

  const note = document.createElement('p');
  note.style.margin = '12px 0 0';
  note.style.fontSize = '12px';
  note.style.color = '#666';
  note.textContent = 'Exibindo 5 de 20 registros';

  content.appendChild(closeBtn);
  content.appendChild(title);
  content.appendChild(alertMsg);
  content.appendChild(table);
  content.appendChild(note);
  overlay.appendChild(content);
  document.body.appendChild(overlay);
}

function openCorrigirPopup() {
  const overlay = document.createElement('div');
  overlay.className = 'inlinePopupBackdrop';
  overlay.style.position = 'fixed';
  overlay.style.inset = '0';
  overlay.style.background = 'rgba(0,0,0,.45)';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  overlay.style.zIndex = '10000';

  const content = document.createElement('div');
  content.className = 'inlinePopupContent';
  content.style.width = 'min(720px, 92%)';
  content.style.maxHeight = '70vh';
  content.style.overflow = 'auto';
  content.style.background = '#fff';
  content.style.borderRadius = '6px';
  content.style.padding = '20px';
  content.style.position = 'relative';

  const closeBtn = document.createElement('button');
  closeBtn.className = 'inlinePopupClose';
  closeBtn.textContent = '‚úñ';
  closeBtn.style.position = 'absolute';
  closeBtn.style.top = '6px';
  closeBtn.style.right = '8px';
  closeBtn.style.width = '20px';
  closeBtn.style.height = '20px';
  closeBtn.style.border = 'none';
  closeBtn.style.background = 'transparent';
  closeBtn.style.color = '#333';
  closeBtn.style.fontSize = '12px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.opacity = '0.25';
  closeBtn.addEventListener('mouseenter', () => closeBtn.style.opacity = '0.85');
  closeBtn.addEventListener('mouseleave', () => closeBtn.style.opacity = '0.25');
  closeBtn.addEventListener('click', () => document.body.removeChild(overlay));

  const title = document.createElement('h3');
  title.style.margin = '0 0 16px';
  title.style.fontSize = '18px';
  title.style.color = '#333';
  title.textContent = 'Como Corrigir Rejei√ß√£o de NFS-e';

  const p = document.createElement('p');
  p.style.margin = '0';
  p.style.fontSize = '14px';
  p.style.lineHeight = '1.6';
  p.style.color = '#333';
  p.innerHTML = `
    <strong>Erro E160 - Arquivo em desacordo com o XML Schema</strong><br><br>
    Este erro ocorre quando h√° inconsist√™ncias no formato dos dados enviados para a prefeitura. As causas mais comuns incluem:<br><br>
    ‚Ä¢ Campos obrigat√≥rios n√£o preenchidos<br>
    ‚Ä¢ Formata√ß√£o incorreta de CPF/CNPJ<br>
    ‚Ä¢ Descri√ß√£o do servi√ßo incompleta<br>
    ‚Ä¢ C√≥digo de servi√ßo inv√°lido<br><br>
    Para resolver este problema, verifique todos os dados da nota fiscal e certifique-se de que est√£o preenchidos corretamente conforme as especifica√ß√µes da prefeitura.<br><br>
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35774090022797-Rejei%C3%A7%C3%A3o-ao-emitir-NFS-e-C%C3%B3digo-E160-Descri%C3%A7%C3%A3o-Arquivo-em-desacordo-com-o-XML-Schema" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">Clique aqui para ver o guia completo de corre√ß√£o</a>
  `;

  content.appendChild(closeBtn);
  content.appendChild(title);
  content.appendChild(p);
  overlay.appendChild(content);
  document.body.appendChild(overlay);
}

function toggleChatbot() {
  const chatWindow = document.getElementById('chatbotWindow');
  chatWindow.classList.toggle('open');
  if (chatWindow.classList.contains('open')) {
    document.getElementById('chatInput').focus();
  }
}

function sendChatMessage() {
  const input = document.getElementById('chatInput');
  const message = input.value.trim();
  
  if (message === '') return;
  
  const messagesDiv = document.getElementById('chatbotMessages');
  
  const userMessage = document.createElement('div');
  userMessage.className = 'chat-message user';
  userMessage.innerHTML = `<div class="message-bubble">${message}</div>`;
  messagesDiv.appendChild(userMessage);
  
  input.value = '';
  
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
  
  setTimeout(() => {
    const botMessage = document.createElement('div');
    botMessage.className = 'chat-message bot';
    
    let response = 'Obrigado pela sua mensagem! Como posso ajudar voc√™?';
    
    const lowerMessage = message.toLowerCase();
    if (lowerMessage.includes('nota') || lowerMessage.includes('emitir')) {
      response = 'Para emitir notas fiscais, voc√™ pode acessar a se√ß√£o de vendas e clicar em "Gerar nota fiscal". Precisa de ajuda com algo espec√≠fico?';
    } else if (lowerMessage.includes('certificado')) {
      response = 'Seu certificado digital est√° pr√≥ximo do vencimento. Voc√™ pode atualiz√°-lo clicando no aviso no banner verde acima. Posso ajudar com mais alguma coisa?';
    } else if (lowerMessage.includes('pendente')) {
      response = 'Voc√™ possui 20 notas fiscais pendentes. Clique no link no banner verde para ver os detalhes e corrigir as pend√™ncias.';
    } else if (lowerMessage.includes('ajuda') || lowerMessage.includes('suporte')) {
      response = 'Estou aqui para ajudar! Voc√™ pode me perguntar sobre emiss√£o de notas, certificados digitais, vendas ou qualquer d√∫vida sobre o eNotas. üòä';
    }
    
    botMessage.innerHTML = `<div class="message-bubble">${response}</div>`;
    messagesDiv.appendChild(botMessage);
    
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }, 800);
}

function handleChatKeyPress(event) {
  if (event.key === 'Enter') {
    sendChatMessage();
  }
}

function openNotaModal() {
  document.getElementById('notaModal').classList.add('open');
}

function closeNotaModal() {
  document.getElementById('notaModal').classList.remove('open');
}

function downloadNota() {
  const notaContent = `NFS-e - NOTA FISCAL DE SERVI√áOS ELETR√îNICA - RPS 2142
S√©rie 1, emitido em: 03/10/2025

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
DADOS DO PRESTADOR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

LBR MENTORIA E TREINAMENTOS LTDA
RUA MANOEL EUFR√ÅSIO, 403 APT 171 ANDAR 16 COND RENAISSANCE ED
JUVEV√ä - Curitiba - PR - 80030440
TELEFONE: 4192284899
EMAIL: lilliana.bortolini@gmail.com
CNPJ: 58.680.587/0001-07
INSCRI√á√ÉO MUNICIPAL: 12107664

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
INFORMA√á√ïES DA NOTA
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

N√öMERO DA NOTA: 2194
COMPET√äNCIA: 10/2025
C√ìDIGO DE VERIFICA√á√ÉO: O4UUCA06
DATA DE EMISS√ÉO: 03/10/2025 10:32:35

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
DADOS DO TOMADOR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

NOME / RAZ√ÉO SOCIAL: Cliente Completo
CPF / CNPJ: 111.444.777-35
E-MAIL: teste@teste.com.br
ENDERE√áO: Avenida Assis Chateaubriand, 499
BAIRRO: Floresta
CEP: 30150101
MUNIC√çPIO: Belo Horizonte
UF: MG

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
DISCRIMINA√á√ÉO DOS SERVI√áOS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Servi√ßo de Teste

C√ìDIGO DO SERVI√áO: 802 - Treinamento em desenvolvimento profissional e gerencial
MUNIC√çPIO ONDE O SERVI√áO FOI PRESTADO: 4106902 / Curitiba
NATUREZA DA OPERA√á√ÉO: Tributa√ß√£o no munic√≠pio
REGIME ESPECIAL DE TRIBUTA√á√ÉO: Microempresa Municipal

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
VALORES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

VALOR DOS SERVI√áOS: R$ 1,00
(-) DESCONTOS: R$ 0,00
(-) DEDU√á√ïES: R$ 0,00
(-) RETEN√á√ïES FEDERAIS: R$ 0,00
(=) BASE DE C√ÅLCULO: R$ 1,00
(-) ISS RETIDO NA FONTE: R$ 0,00
(x) AL√çQUOTA: 4,00 %
(=) VALOR DO ISS: R$ 0,04

VALOR L√çQUIDO: R$ 1,00

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
RETEN√á√ïES FEDERAIS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

PIS: R$ 0,00
COFINS: R$ 0,00
IR: R$ 0,00
CSLL: R$ 0,00
INSS: R$ 0,00

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
OUTRAS INFORMA√á√ïES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Documento emitido por ME ou EPP optante pelo simples nacional;

powered by eNotas Gateway`;

  const blob = new Blob([notaContent], { type: 'text/plain;charset=utf-8' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'Nota_Fiscal_2194.txt';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

function showPendenteMessage() {
  const overlay = document.createElement('div');
  overlay.className = 'inlinePopupBackdrop';
  overlay.style.position = 'fixed';
  overlay.style.inset = '0';
  overlay.style.background = 'rgba(0,0,0,.45)';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  overlay.style.zIndex = '10000';

  const content = document.createElement('div');
  content.className = 'inlinePopupContent';
  content.style.width = 'min(450px, 92%)';
  content.style.background = '#fff';
  content.style.borderRadius = '8px';
  content.style.padding = '24px';
  content.style.position = 'relative';
  content.style.textAlign = 'center';

  const closeBtn = document.createElement('button');
  closeBtn.className = 'inlinePopupClose';
  closeBtn.textContent = '‚úñ';
  closeBtn.style.position = 'absolute';
  closeBtn.style.top = '8px';
  closeBtn.style.right = '8px';
  closeBtn.style.width = '24px';
  closeBtn.style.height = '24px';
  closeBtn.style.border = 'none';
  closeBtn.style.background = 'transparent';
  closeBtn.style.color = '#333';
  closeBtn.style.fontSize = '14px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.opacity = '0.4';
  closeBtn.addEventListener('mouseenter', () => closeBtn.style.opacity = '1');
  closeBtn.addEventListener('mouseleave', () => closeBtn.style.opacity = '0.4');
  closeBtn.addEventListener('click', () => document.body.removeChild(overlay));

  const icon = document.createElement('div');
  icon.style.fontSize = '48px';
  icon.style.marginBottom = '16px';
  icon.textContent = '‚è≥';

  const message = document.createElement('p');
  message.style.margin = '0';
  message.style.fontSize = '16px';
  message.style.lineHeight = '1.5';
  message.style.color = '#333';
  message.textContent = 'A nota ser√° emitida ap√≥s o vencimento da garantia';

  content.appendChild(closeBtn);
  content.appendChild(icon);
  content.appendChild(message);
  overlay.appendChild(content);
  document.body.appendChild(overlay);
}

function showErroMessage() {
  const overlay = document.createElement('div');
  overlay.className = 'inlinePopupBackdrop';
  overlay.style.position = 'fixed';
  overlay.style.inset = '0';
  overlay.style.background = 'rgba(0,0,0,.45)';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  overlay.style.zIndex = '10000';

  const content = document.createElement('div');
  content.className = 'inlinePopupContent';
  content.style.width = 'min(520px, 92%)';
  content.style.background = '#fff';
  content.style.borderRadius = '8px';
  content.style.padding = '24px';
  content.style.position = 'relative';
  content.style.textAlign = 'center';

  const closeBtn = document.createElement('button');
  closeBtn.className = 'inlinePopupClose';
  closeBtn.textContent = '‚úñ';
  closeBtn.style.position = 'absolute';
  closeBtn.style.top = '8px';
  closeBtn.style.right = '8px';
  closeBtn.style.width = '24px';
  closeBtn.style.height = '24px';
  closeBtn.style.border = 'none';
  closeBtn.style.background = 'transparent';
  closeBtn.style.color = '#333';
  closeBtn.style.fontSize = '14px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.opacity = '0.4';
  closeBtn.addEventListener('mouseenter', () => closeBtn.style.opacity = '1');
  closeBtn.addEventListener('mouseleave', () => closeBtn.style.opacity = '0.4');
  closeBtn.addEventListener('click', () => document.body.removeChild(overlay));

  const icon = document.createElement('div');
  icon.style.fontSize = '48px';
  icon.style.marginBottom = '16px';
  icon.textContent = '‚ùó';

  const title = document.createElement('h3');
  title.style.margin = '0 0 12px';
  title.style.fontSize = '18px';
  title.style.color = '#c62828';
  title.textContent = 'Erro na Emiss√£o da Nota Fiscal';

  const message = document.createElement('p');
  message.style.margin = '0';
  message.style.fontSize = '15px';
  message.style.lineHeight = '1.6';
  message.style.color = '#333';
  message.style.textAlign = 'left';
  message.innerHTML = `<strong>Ocorreu um erro inesperado.</strong><br><br>
    <strong>Corre√ß√£o:</strong> As poss√≠veis causas s√£o formata√ß√µes XML incorretas.<br><br>
    Para mais detalhes sobre como corrigir este erro, 
    <a href="#" onclick="event.preventDefault(); openErroDetalhesPopup();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">clique aqui</a>.`;

  content.appendChild(closeBtn);
  content.appendChild(icon);
  content.appendChild(title);
  content.appendChild(message);
  overlay.appendChild(content);
  document.body.appendChild(overlay);
}

function openErroDetalhesPopup() {
  const overlay = document.createElement('div');
  overlay.className = 'inlinePopupBackdrop';
  overlay.style.position = 'fixed';
  overlay.style.inset = '0';
  overlay.style.background = 'rgba(0,0,0,.5)';
  overlay.style.display = 'flex';
  overlay.style.alignItems = 'center';
  overlay.style.justifyContent = 'center';
  overlay.style.zIndex = '10001';

  const content = document.createElement('div');
  content.className = 'inlinePopupContent';
  content.style.width = 'min(720px, 92%)';
  content.style.maxHeight = '70vh';
  content.style.overflow = 'auto';
  content.style.background = '#fff';
  content.style.borderRadius = '6px';
  content.style.padding = '20px';
  content.style.position = 'relative';

  const closeBtn = document.createElement('button');
  closeBtn.className = 'inlinePopupClose';
  closeBtn.textContent = '‚úñ';
  closeBtn.style.position = 'absolute';
  closeBtn.style.top = '8px';
  closeBtn.style.right = '8px';
  closeBtn.style.width = '24px';
  closeBtn.style.height = '24px';
  closeBtn.style.border = 'none';
  closeBtn.style.background = 'transparent';
  closeBtn.style.color = '#333';
  closeBtn.style.fontSize = '14px';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.opacity = '0.4';
  closeBtn.addEventListener('mouseenter', () => closeBtn.style.opacity = '1');
  closeBtn.addEventListener('mouseleave', () => closeBtn.style.opacity = '0.4');
  closeBtn.addEventListener('click', () => document.body.removeChild(overlay));

  const title = document.createElement('h3');
  title.style.margin = '0 0 16px';
  title.style.fontSize = '18px';
  title.style.color = '#333';
  title.textContent = 'Rejei√ß√£o ao emitir NFS-e - C√≥digo E160';

  const p = document.createElement('p');
  p.style.margin = '0';
  p.style.fontSize = '14px';
  p.style.lineHeight = '1.6';
  p.style.color = '#333';
  p.innerHTML = `
    <strong>Descri√ß√£o: Arquivo em desacordo com o XML Schema</strong><br><br>
    
    Este erro ocorre quando h√° inconsist√™ncias no formato dos dados enviados para a prefeitura. As causas mais comuns incluem:<br><br>
    
    ‚Ä¢ <strong>Campos obrigat√≥rios n√£o preenchidos:</strong> Verifique se todos os campos necess√°rios est√£o completos.<br>
    ‚Ä¢ <strong>Formata√ß√£o incorreta de CPF/CNPJ:</strong> Certifique-se de que documentos est√£o no formato correto (apenas n√∫meros).<br>
    ‚Ä¢ <strong>Descri√ß√£o do servi√ßo incompleta:</strong> A descri√ß√£o deve ser clara e detalhada.<br>
    ‚Ä¢ <strong>C√≥digo de servi√ßo inv√°lido:</strong> Confirme se o c√≥digo de servi√ßo est√° correto para sua atividade.<br>
    ‚Ä¢ <strong>Dados XML malformados:</strong> Caracteres especiais podem causar problemas na estrutura XML.<br><br>
    
    <strong>Como resolver:</strong><br>
    1. Revise todos os dados da nota fiscal<br>
    2. Corrija os campos com problemas<br>
    3. Tente emitir a nota novamente<br><br>
    
    Se o problema persistir, entre em contato com o suporte t√©cnico.<br><br>
    
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35774090022797-Rejei%C3%A7%C3%A3o-ao-emitir-NFS-e-C%C3%B3digo-E160-Descri%C3%A7%C3%A3o-Arquivo-em-desacordo-com-o-XML-Schema" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">Ver artigo completo no Centro de Ajuda ‚Üí</a>
  `;

  content.appendChild(closeBtn);
  content.appendChild(title);
  content.appendChild(p);
  overlay.appendChild(content);
  document.body.appendChild(overlay);
}

renderTabela();
updateXVisibility();

// Estado do chatbot
let chatState = 'initial';
let awaitingCustomPlatform = false;

// Fun√ß√£o principal de envio de mensagens
function sendChatMessage() {
  const input = document.getElementById('chatInput');
  const message = input.value.trim();
  
  if (message === '') return;
  
  const messagesDiv = document.getElementById('chatbotMessages');
  
  // Adiciona mensagem do usu√°rio
  const userMessage = document.createElement('div');
  userMessage.className = 'chat-message user';
  userMessage.innerHTML = `<div class="message-bubble">${message}</div>`;
  messagesDiv.appendChild(userMessage);
  
  input.value = '';
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
  
  // Se est√° esperando resposta de plataforma customizada
  if (awaitingCustomPlatform) {
    setTimeout(() => {
      const botMessage = document.createElement('div');
      botMessage.className = 'chat-message bot';
      botMessage.innerHTML = `<div class="message-bubble">Obrigado! Registramos sua plataforma: <strong>${message}</strong>. Nossa equipe de suporte entrar√° em contato para auxiliar na integra√ß√£o. üòä<br><br>Precisa de mais alguma ajuda?</div>`;
      messagesDiv.appendChild(botMessage);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
      awaitingCustomPlatform = false;
      chatState = 'initial';
    }, 800);
    return;
  }
  
  // Resposta padr√£o
  setTimeout(() => {
    const botMessage = document.createElement('div');
    botMessage.className = 'chat-message bot';
    let response = showInitialMessage();
    botMessage.innerHTML = `<div class="message-bubble">${response}</div>`;
    messagesDiv.appendChild(botMessage);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }, 800);
}

// Mensagem inicial do chatbot
function showInitialMessage() {
  chatState = 'initial';
  return `Verifiquei que sua conta ainda n√£o foi configurada na plataforma. O nosso time de onboarding realizar√° o primeiro contato at√© 16h √∫teis ap√≥s a compra. J√° deu uma olhadinha no seu e-mail? üòâ<br><br>Caso deseje falar sobre outro assunto, <a href="#" onclick="event.preventDefault(); showMainMenu();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">clique aqui</a>.`;
}

// Menu principal com todas as 9 op√ß√µes
function showMainMenu() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble">
    Escolha uma das op√ß√µes abaixo:<br><br>
    <a href="#" onclick="event.preventDefault(); showPainelVendas();" style="color: #1a73e8; text-decoration: underline; cursor: pointer; display: block; margin: 8px 0;">1 - Falar sobre o painel de vendas</a>
    <a href="#" onclick="event.preventDefault(); showIntegracoes();" style="color: #1a73e8; text-decoration: underline; cursor: pointer; display: block; margin: 8px 0;">2 - Falar sobre a integra√ß√£o com a plataforma de vendas</a>
    <a href="#" onclick="event.preventDefault(); showEmissoesCancelamentos();" style="color: #1a73e8; text-decoration: underline; cursor: pointer; display: block; margin: 8px 0;">3 - Falar sobre minhas emiss√µes/cancelamentos negados</a>
    <a href="#" onclick="event.preventDefault(); showExtrairRelatorios();" style="color: #1a73e8; text-decoration: underline; cursor: pointer; display: block; margin: 8px 0;">4 - Extrair o relat√≥rio PDF e XML</a>
    <a href="#" onclick="event.preventDefault(); showAlterarDados();" style="color: #1a73e8; text-decoration: underline; cursor: pointer; display: block; margin: 8px 0;">5 - Como alterar os meus dados fiscais ou certificado digital?</a>
    <a href="#" onclick="event.preventDefault(); showConfigurarEndereco();" style="color: #1a73e8; text-decoration: underline; cursor: pointer; display: block; margin: 8px 0;">6 - Configurar endere√ßo padr√£o para emiss√£o das notas fiscais</a>
    <a href="#" onclick="event.preventDefault(); showAlteracaoMunicipio();" style="color: #1a73e8; text-decoration: underline; cursor: pointer; display: block; margin: 8px 0;">7 - Realizei altera√ß√£o de munic√≠pio</a>
    <a href="#" onclick="event.preventDefault(); showConfigurarNovoTipo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer; display: block; margin: 8px 0;">8 - Preciso realizar configura√ß√£o de novo tipo de NF</a>
    <a href="#" onclick="event.preventDefault(); showEmissaoAvulsa();" style="color: #1a73e8; text-decoration: underline; cursor: pointer; display: block; margin: 8px 0;">9 - Consigo realizar uma emiss√£o avulsa?</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// OP√á√ÉO 1: Painel de Vendas
function showPainelVendas() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble">
    <strong>Painel de Vendas</strong><br><br>
    Escolha uma op√ß√£o:<br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showFiltrosResumo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Precisa de ajuda com aplica√ß√£o de filtros?</a><br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showAcoesEmMassaResumo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Realizar a√ß√µes em massa</a><br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showCancelarNotaResumo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Cancelar uma nota fiscal</a><br><br>
    <a href="#" onclick="event.preventDefault(); showMainMenu();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar ao menu</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Resumo: Filtros do Painel
function showFiltrosResumo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #1abc9c; padding-left: 12px;">
    <strong>Como usar os filtros do painel de vendas</strong><br><br>
    Os filtros permitem encontrar vendas espec√≠ficas rapidamente. Voc√™ pode filtrar por:<br><br>
    ‚Ä¢ Data de emiss√£o<br>
    ‚Ä¢ Nome do cliente<br>
    ‚Ä¢ Produto vendido<br>
    ‚Ä¢ Canal de venda (Hotmart, Kiwify, etc)<br>
    ‚Ä¢ Status da nota fiscal<br><br>
    Basta preencher os campos desejados e clicar em "Aplicar". üìä<br><br>
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35773616019085" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">üìÑ Abrir artigo completo</a><br><br>
    <a href="#" onclick="event.preventDefault(); showPainelVendas();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Resumo: A√ß√µes em Massa
function showAcoesEmMassaResumo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #1abc9c; padding-left: 12px;">
    <strong>Realizar a√ß√µes em massa</strong><br><br>
    Com as a√ß√µes em massa, voc√™ pode processar v√°rias vendas de uma s√≥ vez:<br><br>
    1. Selecione as vendas usando os checkboxes<br>
    2. Clique em "A√ß√µes em massa"<br>
    3. Escolha a a√ß√£o: gerar notas, cancelar, enviar por e-mail, etc<br><br>
    Isso economiza muito tempo! ‚ö°<br><br>
    <a href="#" onclick="event.preventDefault(); showPainelVendas();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Resumo: Cancelar Nota Fiscal
function showCancelarNotaResumo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #1abc9c; padding-left: 12px;">
    <strong>Como cancelar uma nota fiscal</strong><br><br>
    Para cancelar uma venda/nota fiscal:<br><br>
    1. Localize a venda no painel<br>
    2. Clique nos tr√™s pontinhos (‚ãÆ) ou bot√£o de a√ß√µes<br>
    3. Selecione "Cancelar"<br>
    4. Informe o motivo do cancelamento<br>
    5. Confirme a opera√ß√£o<br><br>
    ‚ö†Ô∏è Aten√ß√£o: O cancelamento √© irrevers√≠vel!<br><br>
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35773357667213" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">üìÑ Abrir artigo completo</a><br><br>
    <a href="#" onclick="event.preventDefault(); showPainelVendas();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// OP√á√ÉO 2: Integra√ß√µes com Plataformas
function showIntegracoes() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble">
    <strong>Integra√ß√£o com Plataforma de Vendas</strong><br><br>
    Escolha sua plataforma:<br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showHotmartResumo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Hotmart</a><br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showKiwifyResumo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Kiwify</a><br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showEduzzResumo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Eduzz</a><br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showOutraPlataforma();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Outra plataforma</a><br><br>
    <a href="#" onclick="event.preventDefault(); showMainMenu();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar ao menu</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Resumo: Hotmart
function showHotmartResumo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #ff6b35; padding-left: 12px;">
    <strong>Integra√ß√£o com Hotmart üî•</strong><br><br>
    A integra√ß√£o permite emitir notas fiscais automaticamente para vendas da Hotmart.<br><br>
    <strong>Voc√™ vai precisar:</strong><br>
    ‚Ä¢ E-mail cadastrado na Hotmart<br>
    ‚Ä¢ Token Hottok (Hot Connect)<br><br>
    <strong>Passos principais:</strong><br>
    1. Acesse Ferramentas na Hotmart<br>
    2. Copie o Webhook URL<br>
    3. Gere e copie o Hottok<br>
    4. Cole os dados no eNotas<br><br>
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35773432368909" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">üìÑ Ver passo a passo completo</a><br><br>
    <a href="#" onclick="event.preventDefault(); showIntegracoes();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Resumo: Kiwify
function showKiwifyResumo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #00d4aa; padding-left: 12px;">
    <strong>Integra√ß√£o com Kiwify ü•ù</strong><br><br>
    Conecte sua conta Kiwify ao eNotas para emiss√£o autom√°tica de notas fiscais.<br><br>
    <strong>O que voc√™ precisa:</strong><br>
    ‚Ä¢ Conta ativa na Kiwify<br>
    ‚Ä¢ Token de API da Kiwify<br><br>
    <strong>Resumo dos passos:</strong><br>
    1. Acesse Configura√ß√µes na Kiwify<br>
    2. V√° em Integra√ß√µes > API<br>
    3. Gere seu token de acesso<br>
    4. Configure no eNotas<br><br>
    Pronto! As notas ser√£o emitidas automaticamente. ‚úÖ<br><br>
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35773471206797" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">üìÑ Ver tutorial completo</a><br><br>
    <a href="#" onclick="event.preventDefault(); showIntegracoes();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Resumo: Eduzz
function showEduzzResumo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #7b3fc5; padding-left: 12px;">
    <strong>Integra√ß√£o com Eduzz üöÄ</strong><br><br>
    Entenda como funciona a coprodu√ß√£o entre eNotas e Eduzz.<br><br>
    <strong>Importante saber:</strong><br>
    ‚Ä¢ A integra√ß√£o √© autom√°tica para coprodu√ß√µes<br>
    ‚Ä¢ Notas s√£o emitidas para o produtor principal<br>
    ‚Ä¢ Coprodutores recebem suas comiss√µes j√° com NF<br><br>
    <strong>Configura√ß√£o:</strong><br>
    1. Ative a integra√ß√£o no painel Eduzz<br>
    2. Configure seus produtos no eNotas<br>
    3. Defina as regras de comiss√£o<br><br>
    Tudo integrado e automatizado! üéØ<br><br>
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35773437963789" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">üìÑ Entender coprodu√ß√£o Eduzz</a><br><br>
    <a href="#" onclick="event.preventDefault(); showIntegracoes();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

function showOutraPlataforma() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble">Por favor, digite o nome da sua plataforma de vendas:</div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
  awaitingCustomPlatform = true;
}

// OP√á√ÉO 3: Emiss√µes/Cancelamentos Negados
function showEmissoesCancelamentos() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble">
    <strong>Emiss√µes/Cancelamentos Negados</strong><br><br>
    Escolha uma op√ß√£o:<br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showReprocessamentoResumo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Reprocessamento de notas com erro na emiss√£o</a><br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showCancelamentoNegadoResumo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Cancelamento negado</a><br><br>
    <a href="#" onclick="event.preventDefault(); showMainMenu();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar ao menu</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Resumo: Reprocessamento
function showReprocessamentoResumo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #e74c3c; padding-left: 12px;">
    <strong>Reprocessar notas com erro ‚ö†Ô∏è</strong><br><br>
    Quando uma nota apresenta erro na emiss√£o, voc√™ pode reprocess√°-la ap√≥s corrigir o problema.<br><br>
    <strong>Como fazer:</strong><br>
    1. Identifique a nota com erro no painel<br>
    2. Verifique qual foi o erro apresentado<br>
    3. Corrija os dados necess√°rios<br>
    4. Clique em "Reprocessar" ou "Tentar novamente"<br><br>
    <strong>Erros comuns:</strong><br>
    ‚Ä¢ Dados cadastrais incompletos<br>
    ‚Ä¢ Certificado digital vencido<br>
    ‚Ä¢ C√≥digo de servi√ßo incorreto<br><br>
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35773529645325" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">üìÑ Ver guia completo de reprocessamento</a><br><br>
    <a href="#" onclick="event.preventDefault(); showEmissoesCancelamentos();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Resumo: Cancelamento Negado
function showCancelamentoNegadoResumo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #e74c3c; padding-left: 12px;">
    <strong>Cancelamento Negado üö´</strong><br><br>
    Algumas notas n√£o podem ser canceladas automaticamente pela prefeitura.<br><br>
    <strong>Como filtrar cancelamentos negados:</strong><br>
    1. Acesse o painel de vendas<br>
    2. Use o filtro de Status<br>
    3. Selecione "Cancelamento Negado"<br>
    4. Visualize a lista de notas<br><br>
    <strong>O que fazer:</strong><br>
    ‚Ä¢ Verifique o motivo da negativa<br>
    ‚Ä¢ Entre em contato com a prefeitura se necess√°rio<br>
    ‚Ä¢ Solicite suporte ao eNotas para casos complexos<br><br>
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35773410509197" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">üìÑ Saiba mais sobre cancelamentos negados</a><br><br>
    <a href="#" onclick="event.preventDefault(); showEmissoesCancelamentos();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// OP√á√ÉO 4: Extrair Relat√≥rios
function showExtrairRelatorios() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble">
    <strong>Extrair Relat√≥rios PDF e XML</strong><br><br>
    Escolha uma op√ß√£o:<br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showRelatorioPeriodoResumo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Extrair relat√≥rios de um per√≠odo espec√≠fico</a><br><br>
    ‚Ä¢ <a href="#" onclick="event.preventDefault(); showRelatorioNotaResumo();" style="color: #1a73e8; text-decoration: underline; cursor: pointer;">Apenas de uma nota fiscal</a><br><br>
    <a href="#" onclick="event.preventDefault(); showMainMenu();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar ao menu</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Resumo: Relat√≥rio de Per√≠odo
function showRelatorioPeriodoResumo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #3498db; padding-left: 12px;">
    <strong>Extrair relat√≥rios de per√≠odo üìä</strong><br><br>
    Baixe PDFs, XMLs ou CSVs de todas as notas fiscais de um per√≠odo espec√≠fico.<br><br>
    <strong>Como fazer (Vis√£o do Contador):</strong><br>
    1. Acesse Menu Empresa<br>
    2. Clique em "Relat√≥rios" ou "Exportar"<br>
    3. Selecione o per√≠odo desejado<br>
    4. Escolha o formato (PDF, XML ou CSV)<br>
    5. Clique em "Baixar" ou "Exportar"<br><br>
    <strong>Formatos dispon√≠veis:</strong><br>
    ‚Ä¢ PDF - Para impress√£o e visualiza√ß√£o<br>
    ‚Ä¢ XML - Para importar em sistemas cont√°beis<br>
    ‚Ä¢ CSV - Para an√°lises em planilhas<br><br>
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35773346958221" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">üìÑ Tutorial completo de exporta√ß√£o</a><br><br>
    <a href="#" onclick="event.preventDefault(); showExtrairRelatorios();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Resumo: Relat√≥rio de Nota Espec√≠fica
function showRelatorioNotaResumo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #3498db; padding-left: 12px;">
    <strong>Acessar PDF de nota espec√≠fica üìÑ</strong><br><br>
    Baixe ou visualize o PDF de uma √∫nica nota fiscal.<br><br>
    <strong>Passo a passo:</strong><br>
    1. Localize a nota no painel de vendas<br>
    2. Clique no √≠cone de "Visualizar" ou "‚ãÆ"<br>
    3. Selecione "Ver PDF" ou "Baixar PDF"<br>
    4. O arquivo ser√° aberto/baixado<br><br>
    <strong>Dica r√°pida:</strong><br>
    Voc√™ tamb√©m pode clicar direto no n√∫mero da nota para visualiz√°-la! üöÄ<br><br>
    <strong>Precisa do XML?</strong><br>
    Use a mesma op√ß√£o e escolha "Baixar XML"<br><br>
    <a href="https://atendimento.enotas.com.br/hc/pt-br/articles/35773301267213" target="_blank" rel="noopener" style="color: #1a73e8; text-decoration: underline;">üìÑ Ver tutorial com imagens</a><br><br>
    <a href="#" onclick="event.preventDefault(); showExtrairRelatorios();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// OP√á√ÉO 5: Alterar Dados Fiscais
function showAlterarDados() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #f39c12; padding-left: 12px;">
    <strong>Alterar dados fiscais ou certificado digital üîê</strong><br><br>
    Para altera√ß√µes em dados fiscais ou certificado digital, nossa equipe de suporte precisar√° auxili√°-lo devido √† sensibilidade dessas informa√ß√µes.<br><br>
    <strong>O que pode ser alterado:</strong><br>
    ‚Ä¢ Raz√£o social<br>
    ‚Ä¢ CNPJ/CPF<br>
    ‚Ä¢ Endere√ßo fiscal<br>
    ‚Ä¢ Certificado digital (renova√ß√£o/atualiza√ß√£o)<br>
    ‚Ä¢ Regime tribut√°rio<br><br>
    <strong>Entre em contato:</strong><br>
    üìß E-mail: <strong>suporte@enotas.com.br</strong><br>
    üí¨ Chat no painel (hor√°rio comercial)<br><br>
    ‚ö†Ô∏è <strong>Importante:</strong> Tenha em m√£os os documentos atualizados!<br><br>
    <a href="#" onclick="event.preventDefault(); showMainMenu();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar ao menu</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// OP√á√ÉO 6: Configurar Endere√ßo Padr√£o
function showConfigurarEndereco() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #9b59b6; padding-left: 12px;">
    <strong>Configurar endere√ßo padr√£o üìç</strong><br><br>
    O endere√ßo padr√£o √© usado automaticamente na emiss√£o de todas as suas notas fiscais.<br><br>
    <strong>Como configurar:</strong><br>
    1. Acesse o <strong>Menu Empresa</strong><br>
    2. Clique em <strong>Configura√ß√µes</strong><br>
    3. V√° em <strong>Endere√ßo Padr√£o</strong><br>
    4. Preencha os campos:<br>
       ‚Ä¢ CEP<br>
       ‚Ä¢ Logradouro<br>
       ‚Ä¢ N√∫mero<br>
       ‚Ä¢ Complemento (se houver)<br>
       ‚Ä¢ Bairro<br>
       ‚Ä¢ Cidade e Estado<br>
    5. Clique em <strong>Salvar</strong><br><br>
    ‚úÖ Pronto! Todas as novas notas usar√£o este endere√ßo.<br><br>
    Precisa de mais ajuda? Entre em contato com nosso suporte.<br><br>
    <a href="#" onclick="event.preventDefault(); showMainMenu();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar ao menu</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// OP√á√ÉO 7: Altera√ß√£o de Munic√≠pio
function showAlteracaoMunicipio() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #e67e22; padding-left: 12px;">
    <strong>Altera√ß√£o de munic√≠pio üè¢‚û°Ô∏èüè¢</strong><br><br>
    Mudou sua empresa de cidade? Este processo requer aten√ß√£o especial!<br><br>
    <strong>O que precisa ser atualizado:</strong><br>
    ‚Ä¢ Inscri√ß√£o municipal (nova cidade)<br>
    ‚Ä¢ Certificado digital (mesmo CNPJ, novo munic√≠pio)<br>
    ‚Ä¢ Endere√ßo fiscal completo<br>
    ‚Ä¢ Configura√ß√µes de impostos (podem variar)<br><br>
    <strong>Documentos necess√°rios:</strong><br>
    ‚Ä¢ Alvar√° da nova cidade<br>
    ‚Ä¢ Nova inscri√ß√£o municipal<br>
    ‚Ä¢ Certificado digital atualizado<br>
    ‚Ä¢ Comprovante de endere√ßo<br><br>
    <strong>Como proceder:</strong><br>
    üìß Entre em contato: <strong>suporte@enotas.com.br</strong><br>
    Nossa equipe far√° todo o processo de migra√ß√£o com voc√™! ü§ù<br><br>
    <a href="#" onclick="event.preventDefault(); showMainMenu();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar ao menu</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// OP√á√ÉO 8: Configurar Novo Tipo de NF
function showConfigurarNovoTipo() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #16a085; padding-left: 12px;">
    <strong>Configurar novo tipo de NF üìã</strong><br><br>
    Precisa emitir um tipo diferente de nota fiscal? Podemos ajudar!<br><br>
    <strong>Tipos de nota dispon√≠veis:</strong><br>
    ‚Ä¢ NFS-e (Servi√ßos)<br>
    ‚Ä¢ NF-e (Produtos)<br>
    ‚Ä¢ NFC-e (Consumidor)<br>
    ‚Ä¢ CT-e (Transporte)<br><br>
    <strong>Cada munic√≠pio tem suas regras!</strong><br>
    As configura√ß√µes variam conforme:<br>
    ‚Ä¢ Legisla√ß√£o local<br>
    ‚Ä¢ Sistema da prefeitura<br>
    ‚Ä¢ Atividade da empresa<br>
    ‚Ä¢ Regime tribut√°rio<br><br>
    <strong>Solicite configura√ß√£o:</strong><br>
    üìß E-mail: <strong>suporte@enotas.com.br</strong><br>
    Informe qual tipo de NF voc√™ precisa configurar!<br><br>
    Nossa equipe t√©cnica far√° toda a configura√ß√£o para voc√™. üë®‚Äçüíª<br><br>
    <a href="#" onclick="event.preventDefault(); showMainMenu();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar ao menu</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// OP√á√ÉO 9: Emiss√£o Avulsa
function showEmissaoAvulsa() {
  const messagesDiv = document.getElementById('chatbotMessages');
  const botMessage = document.createElement('div');
  botMessage.className = 'chat-message bot';
  botMessage.innerHTML = `<div class="message-bubble" style="border-left: 3px solid #27ae60; padding-left: 12px;">
    <strong>Emiss√£o avulsa de nota fiscal ‚úçÔ∏è</strong><br><br>
    Sim! Voc√™ pode emitir notas fiscais manualmente atrav√©s do menu:<br>
    <strong>Vendas ‚Üí Nova Venda Manual</strong><br><br>
    <strong>Passo a passo:</strong><br>
    1. Clique em <strong>"Nova Venda Manual"</strong><br>
    2. Preencha os dados do <strong>cliente</strong>:<br>
       ‚Ä¢ Nome/Raz√£o Social<br>
       ‚Ä¢ CPF/CNPJ<br>
       ‚Ä¢ E-mail<br>
       ‚Ä¢ Endere√ßo<br>
    3. Adicione o <strong>produto/servi√ßo</strong>:<br>
       ‚Ä¢ Descri√ß√£o<br>
       ‚Ä¢ C√≥digo de servi√ßo<br>
       ‚Ä¢ Valor<br>
    4. Revise os dados<br>
    5. Clique em <strong>"Emitir Nota Fiscal"</strong><br><br>
    ‚úÖ Pronto! A nota ser√° emitida na hora e enviada por e-mail automaticamente. üòä<br><br>
    <strong>Dica:</strong> Salve clientes frequentes para facilitar emiss√µes futuras!<br><br>
    <a href="#" onclick="event.preventDefault(); showMainMenu();" style="color: #7b3fc5; text-decoration: underline; cursor: pointer; font-size: 12px;">‚Üê Voltar ao menu</a>
  </div>`;
  messagesDiv.appendChild(botMessage);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// Fun√ß√µes auxiliares
function toggleChatbot() {
  const chatWindow = document.getElementById('chatbotWindow');
  chatWindow.classList.toggle('open');
  if (chatWindow.classList.contains('open')) {
    document.getElementById('chatInput').focus();
  }
}

function handleChatKeyPress(event) {
  if (event.key === 'Enter') {
    sendChatMessage();
  }
}
  
  // Toggle dropdown do bot√£o Ajuda superior
function toggleAjudaDropdown() {
  const dropdown = document.getElementById('ajudaDropdown');
  dropdown.classList.toggle('open');
}

// Fechar dropdown ao clicar fora
document.addEventListener('click', function(event) {
  const ajudaSuperior = document.querySelector('.ajuda-superior');
  const dropdown = document.getElementById('ajudaDropdown');
  
  if (ajudaSuperior && dropdown && !ajudaSuperior.contains(event.target)) {
    dropdown.classList.remove('open');
  }
});

// Fun√ß√£o para mostrar p√°gina de Empresa
function showEmpresa() {
  const vendasPage = document.getElementById('vendasPage');
  const appsPage = document.getElementById('appsPage');
  const empresaPage = document.getElementById('empresaPage');
  
  if (vendasPage) vendasPage.style.display = 'none';
  if (appsPage) {
    appsPage.classList.remove('active');
    appsPage.style.display = 'none';
  }
  if (empresaPage) {
    empresaPage.classList.add('active');
    empresaPage.style.display = 'block';
  }
  
  document.querySelectorAll('.menu-item').forEach(item => {
    item.classList.remove('active');
  });
  
  const menuItems = document.querySelectorAll('.menu-item');
  if (menuItems[2]) menuItems[2].classList.add('active');
}

</script>

</body>
</html>