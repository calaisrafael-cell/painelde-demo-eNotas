<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>eNotas - Painel de Vendas</title>
<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: #f8f9fb;
    margin: 0;
    padding: 0;
  }

  .container {
    max-width: 1200px;
    margin: 30px auto;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    overflow: hidden;
  }

  /* BANNERS SUPERIORES */
  .banners {
    display: flex;
    border-bottom: 1px solid #e5e5e5;
  }

  .banner {
    flex: 1;
    padding: 16px 20px;
    position: relative;
    color: #fff;
    transition: all 0.3s ease;
  }

  .banner h3 {
    margin: 0 0 8px;
    font-size: 16px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .banner ul {
    margin: 0;
    padding-left: 20px;
    color: #fff;
  }

  .banner a {
    color: #cce0ff;
    text-decoration: underline;
    cursor: pointer;
  }

  .banner.roxo { background: #7b3fc5; }
  .banner.verde { background: #1abc9c; }

  .expandir {
    position: absolute;
    top: 10px;
    right: 12px;
    cursor: pointer;
    font-weight: bold;
    font-size: 18px;
    opacity: 0.8;
  }

  .expandir:hover { opacity: 1; }

  .banner.expandido {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 50;
    overflow-y: auto;
    border-radius: 0;
    padding: 40px;
  }

  .banner.expandido .expandir::after {
    content: "‚úï";
  }

  /* X dentro do banner ao expandir (no canto superior direito, dentro do overlay) */
  .fechar-internal {
    display: none; /* oculto por padr√£o; aparece apenas no expandido */
  }

  /* Ao expandir, colocar o X dentro do overlay, no canto superior direito */
  .banner.expandido .fechar-internal {
    display: inline-flex;
    position: fixed;                /* fixa no canto superior direito da tela expandida */
    top: 12px;
    right: 12px;
    width: 38px;
    height: 38px;
    border-radius: 4px;
    border: 2px solid #fff;
    background: #e53935;
    color: #fff;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-weight: bold;
    z-index: 60;
  }
  .banner.expandido .fechar-internal:hover {
    background: #c62828;
  }

  /* Ocultar o bot√£o expandir ao expandir o banner */
  .banner.expandido .expandir {
    display: none;
  }

  /* A√ß√µes em Massa ‚Äì estilo da √°rea com t√≠tulo e dropdown */
  .acoes {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    background: #fafafa;
    position: relative;
  }

  .acoes .titulo {
    font-weight: 600;
    cursor: pointer;
    padding: 6px 10px;
    border-radius: 6px;
    border: 1px solid #ddd;
    background: #fff;
  }

  .acoes-dropdown {
    display: none;
    position: absolute;
    left: 0;
    top: calc(100% + 6px);
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,.15);
    z-index: 40;
  }

  .acoes-dropdown button {
    display: block;
    width: 240px;
    background: #f8f8f8;
    border: 1px solid #ddd;
    padding: 8px 12px;
    text-align: left;
    border-radius: 6px;
    cursor: pointer;
    margin: 2px 0;
  }

  .acoes-dropdown button:hover {
    background: #eaeaea;
  }

  /* bot√£o de filtro (funil) */
  .btnFiltro {
    margin-left: auto;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 6px;
    background: #fff;
    cursor: pointer;
  }
  .btnFiltro svg {
    width: 16px; height: 16px;
  }

  .filtros-panel {
    display: none;
    position: absolute;
    right: 14px;
    top: 46px;
    width: 320px;
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 12px;
    box-shadow: 0 8px 20px rgba(0,0,0,.15);
    z-index: 50;
  }

  .filtros-panel h4 {
    margin: 0 0 8px;
    font-size: 14px;
    font-weight: 700;
  }

  .filtros-row {
    display: flex;
    gap: 8px;
    align-items: center;
    margin: 6px 0;
  }

  .filtros-panel label {
    font-size: 12px;
    color: #555;
  }

  .filtros-panel input, .filtros-panel select {
    font: inherit;
    padding: 6px 8px;
    border-radius: 4px;
    border: 1px solid #ccc;
  }

  .filtros-actions {
    display: flex;
    justify-content: space-between;
    margin-top: 6px;
  }

  /* TABELA */
  table {
    width: 100%;
    border-collapse: collapse;
  }

  thead {
    background: #f2f3f5;
    color: #555;
    text-align: left;
  }

  th, td {
    padding: 12px 16px;
    border-bottom: 1px solid #eee;
    font-size: 14px;
  }

  tbody {
    display: block;
    max-height: 320px;
    overflow-y: auto;
  }

  thead, tbody tr {
    display: table;
    width: 100%;
    table-layout: fixed;
  }

  tbody tr:hover {
    background: #fafafa;
  }

  .checkboxCol {
    width: 40px;
  }

  .badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 13px;
    font-weight: 500;
  }

  .badge.emitida {
    background: #d4f5e0;
    color: #2e8b57;
  }

  .badge.pendente {
    background: #ffe6b3;
    color: #a87b00;
  }

  .icon {
    width: 16px;
    height: 16px;
    vertical-align: middle;
  }

  .tooltip {
    position: relative;
    display: inline-block;
  }

  .tooltip .tooltiptext {
    visibility: hidden;
    background-color: #333;
    color: #fff;
    text-align: center;
    padding: 4px 8px;
    border-radius: 6px;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    transform: translateX(-50%);
    font-size: 12px;
    white-space: nowrap;
  }

  .tooltip:hover .tooltiptext {
    visibility: visible;
  }

  .btn-acao {
    background: #7b3fc5;
    color: #fff;
    border: none;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
  }

  .btn-acao:hover {
    background: #6b2fb5;
  }

  /* A√á√ïES EM MASSA E PAGINA√á√ÉO */
  .paginacao {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-left: auto;
  }

  .paginacao button {
    border: 1px solid #ccc;
    background: #fff;
    padding: 4px 10px;
    border-radius: 6px;
    cursor: pointer;
  }

  .paginacao button:hover {
    background: #f1f1f1;
  }

  /* P√°gina info */
  #paginaInfo {
    font-size: 13px;
    color: #555;
  }

</style>
</head>
<body>

<div class="container">

  <!-- BANNERS -->
  <div class="banners">
    <div class="banner roxo" id="novidades">
      <span class="expandir" onclick="expandirBanner('novidades')">‚õ∂</span>
      <button class="fechar-internal" aria-label="Fechar novidades" onclick="fecharBanner('novidades')">‚úñ</button>
      <h3>üÜï Novidades</h3>
      <ul>
        <li>Fique por dentro das novidades da reforma tribut√°ria, que ser√£o aplicadas a partir de Janeiro/2026. Clique <a>[aqui]</a></li>
        <li>Agora voc√™ tamb√©m pode emitir notas de seus produtos f√≠sicos vendidos na Hotmart, pelo eNotas. Para saber mais, clique <a>[aqui]</a></li>
      </ul>
    </div>

    <div class="banner verde" id="avisos">
      <span class="expandir" onclick="expandirBanner('avisos')">‚õ∂</span>
      <button class="fechar-internal" aria-label="Fechar avisos" onclick="fecharBanner('avisos')">‚úñ</button>
      <h3>üö® Avisos</h3>
      <ul>
        <li>Voc√™ possui <b>20 notas fiscais n√£o emitidas</b>, clique <a>[aqui]</a> para detalhes.</li>
        <li>O seu certificado digital ir√° vencer em <b>10 dias</b>, clique <a>[aqui]</a> para atualiz√°-lo.</li>
      </ul>
    </div>
  </div>

  <!-- A√á√ïES EM MASSA + FILTROS -->
  <div class="acoes" style="position:relative;">
    <div class="titulo" onclick="toggleAcoesDropdown()">A√ß√µes em massa</div>
    <div id="acoesDropdown" class="acoes-dropdown" aria-label="A√ß√µes em massa dropdown" style="display:none;">
      <button onclick="handleAcoes('gerar')">Gerar nota fiscal</button>
      <button onclick="handleAcoes('copiar')">Copiar</button>
      <button onclick="handleAcoes('cancelar')">Cancelar</button>
      <button onclick="handleAcoes('enviar')">Enviar por e-mail</button>
    </div>

    <button id="btnFiltro" class="btnFiltro" onclick="toggleFiltroPanel()" aria-label="Filtros" title="Filtros" style="margin-left: 12px;">
      <span style="display:inline-flex; align-items:center; gap:6px;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-label="Filtro">
          <path d="M3 5h18M6 12h12M10 19h4"/>
        </svg>
        Filtros
      </span>
    </button>

    <div id="filtrosPanel" class="filtros-panel" aria-label="Filtros panel" style="display:none;">
      <h4>Filtros</h4>
      <div class="filtros-row">
        <label>Data inicio</label>
        <input type="date" id="fDataInicio" />
      </div>
      <div class="filtros-row">
        <label>Data fim</label>
        <input type="date" id="fDataFim" />
      </div>
      <div class="filtros-row">
        <label>Cliente</label>
        <input type="text" id="fCliente" placeholder="Nome do cliente" />
      </div>
      <div class="filtros-row">
        <label>Produto</label>
        <input type="text" id="fProduto" placeholder="Produto" />
      </div>
      <div class="filtros-row">
        <label>Canal</label>
        <select id="fCanal">
          <option value="">Todos</option>
          <option>Venda Manual</option>
          <option>Hotmart</option>
        </select>
      </div>
      <div class="filtros-row">
        <label>Status</label>
        <select id="fStatus">
          <option value="">Todos</option>
          <option value="Emitida">Emitida</option>
          <option value="Pendente">Pendente</option>
        </select>
      </div>
      <div class="filtros-actions">
        <button onclick="clearFilters()">Limpar</button>
      </div>
    </div>
  </div>

  <!-- TABELA -->
  <table>
    <thead>
      <tr>
        <th class="checkboxCol"></th> <!-- coluna de sele√ß√£o -->
        <th>Data</th>
        <th>Produto</th>
        <th>Cliente</th>
        <th>Valor</th>
        <th>Notas Fiscais</th>
        <th>Canal</th>
        <th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody id="tabelaVendas">
      <!-- Linhas geradas via JS -->
    </tbody>
  </table>

  <div id="paginaInfo" style="padding:12px 20px; text-align:right; color:#555;">P√°gina 1 de 3</div>

</div>

<script>
/* Dados: 12 itens para 3 p√°ginas (4 por p√°gina) com status variado */
const allVendas = [
  {data:'06/10/2025', produto:'Imers√£o Mestres da Audi√™ncia', cliente:'Leila Carvalho', valor:'R$ 42,90', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'06/10/2025', produto:'Imers√£o Mestres da Audi√™ncia', cliente:'Francisco Helton', valor:'R$ 42,90', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'06/10/2025', produto:'Mentoria Avan√ßada', cliente:'Gisele Montalli', valor:'R$ 150,00', nota:'Pendente', venda:'em garantia', canal:'Venda Manual'},
  {data:'05/10/2025', produto:'Workshop Digital', cliente:'Marcos Silva', valor:'R$ 99,90', nota:'Pendente', venda:'em garantia', canal:'Venda Manual'},

  {data:'04/10/2025', produto:'Curso de Copywriting', cliente:'Ana Pereira', valor:'R$ 79,00', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'03/10/2025', produto:'Trilha de Sucesso', cliente:'Bruno Costa', valor:'R$ 59,00', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'02/10/2025', produto:'Mentoria Express', cliente:'Jo√£o Mendes', valor:'R$ 120,00', nota:'Pendente', venda:'em garantia', canal:'Venda Manual'},
  {data:'01/10/2025', produto:'Programa Premium', cliente:'Patr√≠cia Lima', valor:'R$ 249,00', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},

  {data:'30/09/2025', produto:'Curso Avan√ßado', cliente:'Ricardo Alves', valor:'R$ 89,00', nota:'Pendente', venda:'em garantia', canal:'Venda Manual'},
  {data:'29/09/2025', produto:'Treinamento Pro', cliente:'Carla Nunes', valor:'R$ 129,00', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'28/09/2025', produto:'Curso de SEO', cliente:'Thiago Lima', valor:'R$ 110,00', nota:'Emitida', venda:'realizada', canal:'Venda Manual'},
  {data:'27/09/2025', produto:'Webinar Avan√ßado', cliente:'Lucas Ramos', valor:'R$ 55,00', nota:'Pendente', venda:'em garantia', canal:'Venda Manual'}
];

// Dados para 3 p√°ginas (linhasPorPagina = 4)
let paginaAtual = 1;
let linhasPorPagina = 4;

// filtros
let filtros = {
  dataInicio: '',
  dataFim: '',
  cliente: '',
  produto: '',
  canal: '',
  status: ''
};

function normalizeDate(d) {
  if (!d) return '';
  const dt = new Date(d);
  if (isNaN(dt)) return '';
  // retornar no formato yyyy-mm-dd para compara√ß√£o
  return dt.toISOString().split('T')[0];
}

function aplicarFiltros(lista) {
  const v = lista || allVendas;
  const sIni = filtros.dataInicio ? new Date(filtros.dataInicio) : null;
  const sFim = filtros.dataFim ? new Date(filtros.dataFim) : null;
  return v.filter(x => {
    // Data
    if (sIni || sFim) {
      const dt = new Date(x.data);
      if (sIni && dt < sIni) return false;
      if (sFim && dt > sFim) return false;
    }
    // Cliente
    if (filtros.cliente && !x.cliente.toLowerCase().includes(filtros.cliente.toLowerCase())) return false;
    // Produto
    if (filtros.produto && !x.produto.toLowerCase().includes(filtros.produto.toLowerCase())) return false;
    // Canal
    if (filtros.canal && x.canal !== filtros.canal) return false;
    // Status
    if (filtros.status && x.nota !== filtros.status) return false;
    return true;
  });
}

function renderTabela() {
  const tabela = document.getElementById("tabelaVendas");
  tabela.innerHTML = "";

  // dados atualmente filtrados
  const dadosFiltrados = aplicarFiltros(allVendas);
  const total = dadosFiltrados.length;
  const maxPag = Math.max(1, Math.ceil(total / linhasPorPagina));
  if (paginaAtual > maxPag) paginaAtual = maxPag;

  const inicio = (paginaAtual - 1) * linhasPorPagina;
  const fim = inicio + linhasPorPagina;
  const paginadas = dadosFiltrados.slice(inicio, fim);

  paginadas.forEach((v, idx) => {
    const tr = document.createElement("tr");
    const globalIndex = inicio + idx;

    // Checkbox
    const checkbox = `<td class="checkboxCol" style="text-align:center;">
      <input type="checkbox" class="rowSel" data-id="${globalIndex}">
    </td>`;

    // Data
    // Nota com √≠cones
    let notaHTML = "";
    if (v.nota === "Emitida") {
      notaHTML = `<span class='badge emitida'>
        <span class="tooltip" aria-label="Emitida">
          üñ®Ô∏è
          <span class="tooltiptext">emitida</span>
        </span>
      </span>`;
    } else {
      notaHTML = `<span class='badge pendente tooltip'>
        <span class="tooltip" aria-label="Pendente">
          ‚è≥
          <span class="tooltiptext">pendente</span>
        </span>
      </span>`;
    }

    // A√ß√µes
    const acoesHTML = `<button class='btn-acao'>Visualizar</button>`;

    tr.innerHTML = `
      ${checkbox}
      <td>${v.data}</td>
      <td>${v.produto}</td>
      <td>${v.cliente}</td>
      <td>${v.valor}</td>
      <td>${notaHTML}</td>
      <td>${v.canal}</td>
      <td>${acoesHTML}</td>
    `;
    tabela.appendChild(tr);
  });

  // Atualiza pagina info e o seletor de p√°gina (1..3)
  const paginaInfo = document.getElementById("paginaInfo");
  if (paginaInfo) {
    paginaInfo.innerText = `P√°gina ${paginaAtual} de ${maxPag}`;
  }
  const paginaSel = document.getElementById("paginaSelector");
  if (paginaSel) {
    paginaSel.innerHTML = "";
    for (let i = 1; i <= 3; i++) {
      const opt = document.createElement("option");
      opt.value = i;
      opt.text = String(i);
      if (i === paginaAtual) opt.selected = true;
      paginaSel.appendChild(opt);
    }
  }
}

function anterior() {
  const maxPag = Math.max(1, Math.ceil(aplicarFiltros(allVendas).length / linhasPorPagina));
  if (paginaAtual > 1) {
    paginaAtual--;
    renderTabela();
  }
}

function proxima() {
  const maxPag = Math.max(1, Math.ceil(aplicarFiltros(allVendas).length / linhasPorPagina));
  if (paginaAtual < maxPag) {
    paginaAtual++;
    renderTabela();
  }
}

function goToPage(p) {
  const page = parseInt(p, 10);
  const maxPag = Math.max(1, Math.ceil(aplicarFiltros(allVendas).length / linhasPorPagina));
  if (page >= 1 && page <= maxPag) {
    paginaAtual = page;
    renderTabela();
  }
}

/* A√ß√µes em massa dropdown (j√° existente) */
function toggleAcoesDropdown() {
  const dd = document.getElementById("acoesDropdown");
  dd.style.display = dd.style.display === "block" ? "none" : "block";
}
function handleAcoes(action) {
  alert("A√ß√£o em massa: " + action);
  document.getElementById("acoesDropdown").style.display = "none";
}

/* Filtros panel */
function toggleFiltroPanel() {
  const panel = document.getElementById("filtrosPanel");
  panel.style.display = panel.style.display === "block" ? "none" : "block";
}
function applyFiltersFromUI() {
  filtros.dataInicio = document.getElementById("fDataInicio").value;
  filtros.dataFim = document.getElementById("fDataFim").value;
  filtros.cliente = document.getElementById("fCliente").value;
  filtros.produto = document.getElementById("fProduto").value;
  filtros.canal = document.getElementById("fCanal").value;
  filtros.status = document.getElementById("fStatus").value;
  paginaAtual = 1;
  renderTabela();
}
function clearFilters() {
  document.getElementById("fDataInicio").value = "";
  document.getElementById("fDataFim").value = "";
  document.getElementById("fCliente").value = "";
  document.getElementById("fProduto").value = "";
  document.getElementById("fCanal").value = "";
  document.getElementById("fStatus").value = "";
  filtros = { dataInicio:'', dataFim:'', cliente:'', produto:'', canal:'', status:'' };
  paginaAtual = 1;
  renderTabela();
}
function refreshFiltersOnInput() {
  // aplica filtros de forma incremental
  applyFiltersFromUI();
}

document.addEventListener('click', (e) => {
  // fecha pain√©is quando clicar fora
  const acoesBox = document.querySelector('.acoes');
  const targetInsideAcoes = acoesBox.contains(e.target);
  const filtrosPanel = document.getElementById('filtrosPanel');
  if (!targetInsideAcoes && filtrosPanel && !filtrosPanel.contains(e.target)) {
    filtrosPanel.style.display = 'none';
  }
});

// Atualiza o filtro a cada altera√ß√£o
document.addEventListener('input', (e) => {
  if (e.target.closest('#fDataInicio') || e.target.closest('#fDataFim') ||
      e.target.closest('#fCliente') || e.target.closest('#fProduto') ||
      e.target.closest('#fCanal') || e.target.closest('#fStatus')) {
    // aplicar automaticamente
    refreshFiltersOnInput();
  }
});

function expandirBanner(id) {
  const banner = document.getElementById(id);
  const expandido = banner.classList.contains("expandido");
  document.querySelectorAll(".banner").forEach(b => b.classList.remove("expandido"));
  if (!expandido) banner.classList.add("expandido");
  // manter X dentro do banner ao expandir
  // atualiza√ß√£o de visibilidade do X
  updateXVisibility();
}
function fecharBanner(id) {
  const banner = document.getElementById(id);
  if (banner) banner.classList.remove("expandido");
  updateXVisibility();
}
function updateXVisibility() {
  document.querySelectorAll(".banner").forEach(b => {
    const isExpanded = b.classList.contains("expandido");
    const xBtn = b.querySelector(".fechar-internal");
    if (xBtn) xBtn.style.display = isExpanded ? "inline-flex" : "none";
  });
}

renderTabela();
updateXVisibility();
</script>

</body>
</html>
